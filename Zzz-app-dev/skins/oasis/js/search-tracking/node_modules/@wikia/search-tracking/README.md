# Search tracking library

This library allows to build and send data structures that are required to track and analyze
search functionalities on Fandom services.

## Building and running the code

In order to build, run and have fun with the code you need to have `node` and `npm` installed
and run `npm install`.

In order to play with the project run:

```bash
npm start
```

This command will run a webpack server that will watch for changes in code and hot reload on save.
Moreover, it will open the window in your system browser and display a blank window. You can run
devtools of your browser and try instantiate the classes, build simple pipelines, etc.

In order to ceate a production version (ES5 minified and uglified) of this script run:

```bash
npm run build
```

The new version will be available under `./dist/searchtracking.js`. The users can either directly copy/paste the file or code
to their codebase or serve it through a CDN.

## Usage on production

The library exposes only one function on `window` object: `sendEvent`. This function accepts an object with two fields - `type` and `payload`.
The type of the event must be on of four options (string):

- "searchImpression",
- "searchClicked",
- "suggestImpression",
- "suggestClicked".

`Payload` should contain an object that is build according with the [documentation](https://wikia-inc.atlassian.net/wiki/spaces/DE/pages/474710211/Search+Tracking+Events).

Function `sendEvent` performs validation of the data structure and sends that data to `beacon.wikia-services.com`. If the value in `payload` is inappropriate it will throw an exception.

## Tests

In order to run tests run `npm test`. Currently, only limited number of tests is provided. Eventually,
all fields require in validation process should be tested.
