! function(r) {
  "use strict";

  function e(r, o) {
    var a = o.shift(),
      l = o;
    if (null !== r) {
      if (0 === l.length) return r[a];
      if ("object" == typeof r) return e(r[a], l)
    }
    return r
  }

  function o() {
    if (!r.trumbowyg && !r.trumbowyg.addedXhrProgressEvent) {
      var e = r.ajaxSettings.xhr;
      r.ajaxSetup({
        xhr: function() {
          var r = e(),
            o = this;
          return r && "object" == typeof r.pdfupload && void 0 !== o.progressPdfUpload && r.pdfupload.addEventListener("progress", function(r) {
            o.progressPdfUpload(r)
          }, !1), r
        }
      }), r.trumbowyg.addedXhrProgressEvent = !0
    }
  }
  var a = {
    serverPath: "./src/plugins/pdfupload/trumbowyg.pdfupload.php",
    fileFieldName: "fileToPdfUpload",
    data: [],
    headers: {},
    xhrFields: {},
    urlPropertyName: "file",
    statusPropertyName: "success",
    success: void 0,
    error: void 0
  };
  o(), r.extend(!0, r.trumbowyg, {
    langs: {
      en: {
        pdfupload: "PdfUpload",
        file: "File",
        pdfuploadError: "Error"
      },
      sk: {
        upload: "Nahrať",
        file: "Súbor",
        uploadError: "Chyba"
      },
      fr: {
        upload: "Envoi",
        file: "Fichier",
        uploadError: "Erreur"
      },
      cs: {
        upload: "Nahrát obrázek",
        file: "Soubor",
        uploadError: "Chyba"
      },
      zh_cn: {
        upload: "上传",
        file: "文件",
        uploadError: "错误"
      },
      zh_tw: {
        upload: "上傳",
        file: "文件",
        uploadError: "錯誤"
      },
      ru: {
        upload: "Загрузка",
        file: "Файл",
        uploadError: "Ошибка"
      },
      ja: {
        upload: "アップロード",
        file: "ファイル",
        uploadError: "エラー"
      },
      pt_br: {
        upload: "Enviar do local",
        file: "Arquivo",
        uploadError: "Erro"
      }
    },
    plugins: {
      pdfupload: {
        init: function(o) {
          o.o.plugins.pdfupload = r.extend(!0, {}, a, o.o.plugins.pdfupload || {});
          var l = {
            fn: function() {
              o.saveRange();
              var a, l = o.o.prefix,
                t = o.openModalInsert(o.lang.pdfupload, {
                  file: {
                    type: "file",
                    required: !0,
                    attributes: {
                      name: 'uploadFile'
                    }
                  },
                  alt: {
                    label: "description",
                    value: o.getRangeText()
                  }
                }, function(u) {
                  var p = new FormData;
                  p.append(o.o.plugins.pdfupload.fileFieldName, a), o.o.plugins.pdfupload.data.map(function(r) {
                    p.append(r.name, r.value)
                  }), r.map(u, function(r, e) {
                    "file" !== e && p.append(e, r)
                  }), 0 === r("." + l + "progress", t).length && r("." + l + "modal-title", t).after(r("<div/>", {
                    "class": l + "progress"
                  }).append(r("<div/>", {
                    "class": l + "progress-bar"
                  }))), r.ajax({
                    url: o.o.plugins.pdfupload.serverPath,
                    headers: o.o.plugins.pdfupload.headers,
                    xhrFields: o.o.plugins.pdfupload.xhrFields,
                    type: "POST",
                    data: p,
                    cache: !1,
                    dataType: "json",
                    processData: !1,
                    contentType: !1,
                    progressPdfUpload: function(e) {
                      r("." + l + "progress-bar").stop().animate({
                        width: Math.round(100 * e.loaded / e.total) + "%"
                      }, 200)
                    },
                    success: function(a) {
                      if (o.o.plugins.pdfupload.success) o.o.plugins.pdfupload.success(a, o, t, u);
                      else if (e(a, o.o.plugins.pdfupload.statusPropertyName.split("."))) {
                        var l = e(a, o.o.plugins.pdfupload.urlPropertyName.split("."));
                        o.execCmd("insertImage", l), r('img[src="' + l + '"]:not([alt])', o.$box).attr("alt", u.alt), setTimeout(function() {
                          o.closeModal()
                        }, 250), o.$c.trigger("tbwpdfuploadsuccess", [o, a, l])
                      } else o.addErrorOnModalField(r("input[type=file]", t), o.lang[a.message]), o.$c.trigger("tbwpdfuploaderror", [o, a])
                    },
                    error: o.o.plugins.pdfupload.error || function() {
                      o.addErrorOnModalField(r("input[type=file]", t), o.lang.pdfuploadError), o.$c.trigger("tbwpdfuploaderror", [o])
                    }
                  })
                });
              r("input[type=file]").on("change", function(r) {
                try {
                  a = r.target.files[0]
                } catch (e) {
                  a = r.target.value
                }
              })
            }
          };
          o.addBtnDef("pdfupload", l)
        }
      }
    }
  })
}(jQuery);
