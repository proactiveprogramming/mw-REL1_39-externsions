<link rel="stylesheet" type="text/css" href="<?php echo $this->ScriptPath.'/extensions/ITaskTracker/scripts/jedit_table/jquery-ui-1.8.16.custom.css';?>" media="screen">
<link rel="stylesheet" type="text/css" href="<?php echo $this->ScriptPath.'/extensions/ITaskTracker/scripts/screen.css';?>" media="screen">

<?php if ($this->isIbugLoggedIn){
global $wgServerName,$wgProto ;
echo '<script type="text/javascript">';
echo 'function ConfirmArchive(IDbug){';
echo 'var answer = confirm ("Do you Really Want to Archive This Issue ?");';
echo 'if (answer){';
echo 'window.location="'.$wgProto.$this->deleteUrl . '"+IDbug;';
echo '}}';
echo '</script>';
} ?>

<?php
include ("extensions/ITaskTracker/scripts/sortFunction_list/sort_function_list.php");
$dttoday = date("d-M-Y");

$gantt_api = "https://".$wgServerName."/api/wiki_itask/v1.0/action/gantt_chart";
$aluser = strtolower($this->getUsrName);
$apikey = $this->encripted_user; 

$cookie_name = "wiki_user";
$cookie_value = $this->getUsrName;
setcookie($cookie_name, $cookie_value, time() + (86400 * 1), "/", $_SERVER['SERVER_NAME']); // 86400 = 1 day

?>

<?php   //array take value  
	foreach ($this->issueStatus as $name => $status): 
            if ($status['Gstatus']!=='ori1' && $status['Gstatus']!=='ori2') {
		$l_status[]=$name."':'".$status['name'];  
                $l_status[]=$name."':'".str_replace('Bug','iTask',$status['name']);  
                    if ($status['name']!=='Bug Approved' && $status['name']!=='Bug Cancelled' && $status['name']!=='Bug Pending Development') {
                    $l_status_0[] =$name."':'".$status['name'];          
                    $l_status_0[] =$name."':'".str_replace('Bug','iTask',$status['name']);          
                    }
                    if ($status['name']=='Bug Working' || $status['name']=='Bug Feedback') {
                    $l_statusN[1][] =$name."':'".$status['name'];          
                    $l_statusN[1][] =$name."':'".str_replace('Bug','iTask',$status['name']);          
                    }
                    if ($status['name']=='Bug Feedback' || $status['name']=='Bug Pending Approval') {
                    $l_statusN[2][] =$name."':'".$status['name'];          
                    $l_statusN[2][] =$name."':'".str_replace('Bug','iTask',$status['name']);          
                    }
                    if ($status['name']=='Bug Working' || $status['name']=='Bug Approved') {
                    $l_statusN[3][] =$name."':'".$status['name'];          
                    $l_statusN[3][] =$name."':'".str_replace('Bug','iTask',$status['name']);          
                    }
                    if ($status['name']=='Bug Working' || $status['name']=='Bug Pending Development' || $status['name']=='Bug Cancelled' ) {
                    $l_statusN[4][] =$name."':'".$status['name'];          
                    $l_statusN[4][] =$name."':'".str_replace('Bug','iTask',$status['name']);          
                    }
                    if ($status['name']=='Bug Pending Feedback' || $status['name']=='Bug Working' || $status['name']=='Bug Pending Development' || $status['name']=='Bug Cancelled' || $status['name']=='Bug Approved') {
                    $l_statusN[5][] =$name."':'".$status['name'];          
                    $l_statusN[5][] =$name."':'".str_replace('Bug','iTask',$status['name']);          
                    }
                }
                    //$arrColour[$status['name']]="#".$status['colour'];                     
                    $arrColour[str_replace('Bug','iTask',$status['name'])]="#".$status['colour'];                     
 	endforeach;            
        
	foreach ($this->issueOwned_by as $name => $owner):
        	$l_owner[]=$name."':'".$owner['name'];
                $l_owner_list[]=$owner['name'];
    	endforeach;
        $l_owner_1[]= "None"."':'"."None";
        $l_owner_1[]=$this->getUsrName."':'".$this->getUsrName;

	foreach ($this->issueCoor_by as $name => $coordinator):
        	$l_coor[]=$name."':'".$coordinator['name'];
    	endforeach;

	foreach ($this->issueApprov_by as $name => $apprval):
        	$l_app[]=$name."':'".$apprval['name'];
    	endforeach;

	$_POST=null;
	foreach ($this->issuePriority as $name => $prior):
		if (($prior['name']!='URGENT') ||  ($prior['name']=='URGENT') && $_POST['bt_priority']==1 || ($this->isIbugUrgent($this->getUsrName)==1)){
			$l_prior[]=$name."':'".$prior['name'];}
    	endforeach;
                        
        $l_parent[] = "0"."':'"."None";
        foreach ($this->projectParent as $key => $val):	
                $arr_value = explode("-",$val);                		
                //$l_parent[]=$arr_value[0]."-".$arr_value[1]."':'". $arr_value[0]." : ".$arr_value[1];                
                $this->ArrParents[$arr_value[0]."-".$arr_value[1]] = array('parent_id'=>[$arr_value[0]][0]);                                                                                                             
        endforeach;        	                
        
        $l_thme_2[]=''."':'".'None';                 
	while ($thm = $this->pget->fetchObject()){
            $l_thme[]=$thm->tag_name."':'".$thm->theme;
            $l_thme_2[]=$thm->tag_name."':'".$thm->theme;                 
            $this->ArrThemes[$thm->tag_name] = array('theme'=>[$thm->theme][0],  
                                                     'colour'=>[$thm->colour][0]                                                                                  
                                                     );      
    	}                     
        
        $this->userAccesEdit = $this->getIbugModel('default')->getUserAccessIbug($this->getUsrName,"edit");
        foreach ($this->userAccesEdit as $UserAcces):
                $l_edittheme[]=$UserAcces['tag_name'];
        endforeach;
        
        $this->userAccesEdit = $this->getIbugModel('default')->getUser_XS($this->getUsrName);
        foreach ($this->userAccesEdit as $UserAcces):
                $l_SXtheme[]=$UserAcces['tag_name'];
        endforeach;                
        
        foreach ($this->issueApprov_by_AL as $Users):
                $l_extuser[]=$Users['name'];
        endforeach;
        //var_dump($l_extuser);         
    $protocol = isset($_SERVER["HTTPS"]) ? 'https://' : 'http://';
    $url_host = $protocol . $_SERVER['SERVER_NAME'];     
    $ArrProj  = $this->all_project_list;
    //var_dump($ArrProj);    
?>

<script type="text/javascript">
    <?php echo file_get_contents($url_host.$this->ScriptPath.'/extensions/ITaskTracker/scripts/jquery/jquery-1.8.3.min.js'); ?>        
    <?php echo file_get_contents($url_host.$this->ScriptPath.'/extensions/ITaskTracker/scripts/jquery-ui-1.9.2/jquery-ui-1.9.2.custom/js/jquery-ui-1.9.2.custom.js'); ?>        
    <?php echo file_get_contents($url_host.$this->ScriptPath.'/extensions/ITaskTracker/scripts/jedit_table/jquery.jeditable.js'); ?>        
    <?php echo file_get_contents($url_host.$this->ScriptPath.'/extensions/ITaskTracker/scripts/jedit_table/jquery.jeditable.datepicker.js'); ?>        
    <?php echo file_get_contents($url_host.$this->ScriptPath.'/extensions/ITaskTracker/scripts/jquery.elastic.source.js'); ?>        
    <?php echo file_get_contents($url_host.$this->ScriptPath.'/extensions/ITaskTracker/scripts/jquery.livequery.js'); ?> 
    
    function ajax_(ids) {    
    val = document.getElementById("div_pry"+ids).innerText;    
        switch (val) {
        case 'URGENT':
            days = 1;
        break;
        case 'High':
            days = 5;
        break;
        case 'Medium':
            days = 30;
        break;
        case 'Low':
            days = 60;
        }
        
        var arr_m = new Array('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');
        var today = new Date();
        var newdate = new Date();
        newdate.setDate(today.getDate()+days);
                
        var day = newdate.getDate();
        var formattedDay = ("0" + day).slice(-2);
        
        var month = newdate.getMonth() + 1;
        var year = newdate.getFullYear();
        var next = formattedDay+"-"+arr_m[month-1]+"-"+year;        
       
        return next;
    }
    
    function show_access_list(ids) {              
        $.ajax({
            type	: "POST",
            url         : "<?php echo ($this->ScriptPath.'/extensions/ITaskTracker/ITaskTrackerAjax.php?method=get_access_list&local='.$this->local); ?>",
            data 	: { ids : ids},
            success	: function(result){
                //console.log(result);
                var text_header = document.getElementById("displayRestriction"+ids).text;                
                if (text_header == "Show Restriction") {
                $('#textRestriction'+ids).html(result);                
                $('#displayRestriction'+ids).html("Hide Restriction");
                }else{
                $('#textRestriction'+ids).html("");
                $('#displayRestriction'+ids).html("Show Restriction");
                }
            }
        });
    }

    function delete_comment(id) {
        var nxt = "<?php echo $dttoday; ?>";
        var parent  = document.activeElement.parentNode.getAttribute("id");        
        var c_id = document.activeElement.getAttribute("id").replace('CID-','');	
        var cid =  document.activeElement.getAttribute("name").replace('c_del','');               
        var dbcon0 =  "<?php echo $this->dbcon; ?>";                                
        dbcon = encodeURIComponent(dbcon0);       

        if(confirm('Are you sure you want to delete this comment ?')===false)
        return false;	
        event.preventDefault();                
        
        $.ajax({
                type: 'get',					                                        
                url: '<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=delete_comment&local=<?php echo $this->local;?>&id='+ c_id + '&user_name=<?php echo $this->getUsrName;?>&dbcon='+dbcon,                                        
                data: '',
                beforeSend: function(){
                },
                success: function(data){                        
                        var obj = JSON.parse(data);   
                        //console.log(obj.total_comment);       
                        if (obj.success==true) {                     
                                var s = document.getElementById(parent).style;
                                s.opacity = 1;
                                (function fade(){(s.opacity-=.1)<0?s.display="none":setTimeout(fade,40)})();
                                document.getElementById('displayText'+cid).innerHTML = "Show "+obj.total_comment+" Comments";    
                        }else{
                                alert(obj.message);        
                        }                     
                }
        });
        $("#div_due"+cid).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
        $("#div_nxtDate"+cid).html("<?php echo $dttoday; ?><br>");    
       
        return false;
    }     
    
    jQuery(document).ready(function($) {      
      	$(document).ready(function(){                
			/*
                        $('.editparent').click(function(){
				var ids=$(this).attr('id').replace('div_par','');	                                
                                $(this).editable('<?php echo $gantt_api;?>', {    
					data   : "{'<?php echo implode('\',\'',$l_parent);?>'}",
                			type   : 'select',
                			submit : 'OK',
                                        cancel : 'Cancel',
                			id   : 'elementid',
                			name : 'value',
					submitdata : {itask_id: ids ,aluser:"<?php echo $aluser;?>",apikey:"<?php echo $apikey;?>",type:"update_parent"},
                			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                			tooltip   : 'Click to Edit Parent Project',
					callback  : function(data, settings){              
                                                var obj = JSON.parse(data);
                                                //console.log(obj.success);
                                                if (obj.success==true) {
                                                   //$("#div_par"+ids).html(obj.parent_id);
                                                   $("#div_par"+ids).html(obj.new_parent);
                                                   var _page = obj.new_parent.split(" - ");
                                                   $("#div_par_page"+ids).html(_page[1]);   
                                                   var page_url = 'https://'+"<?php echo $wgServerName.$this->ArticlePath;?>"+'/'+_page[1];
                                                   $("#div_par_page"+ids).attr("href",page_url); 
                                                }else{
                                                   alert('Internal Server Error');
                                                }                                                                                              
                			}
            			});
			});
                        */

                        $('.editparent').click(function(){
                                var ids=$(this).attr('id').replace('div_par','');	                                                                 
                                $(this).editable('<?php echo $gantt_api;?>', {                                     
                                    loadurl : '<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=get_data&local=<?php echo $this->local;?>',                                        
                                    type    : 'select',
                                    submit  : 'OK',
                                    cancel  : 'Cancel',
                                    id      : 'elementid',                                    
                                    submitdata : {itask_id: ids ,aluser:"<?php echo $aluser;?>",apikey:"<?php echo $apikey;?>",type:"update_parent"},
                                    indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                                    tooltip   : 'Click to Edit Parent Project',
                                        callback  : function(data, settings){              
                                            var obj = JSON.parse(data);
                                            //console.log(obj.success);
                                            if (obj.success==true) {
                                               //$("#div_par"+ids).html(obj.parent_id);
                                               new_phase = (obj.new_parent_)? obj.new_parent_ : "None";
                                               $("#div_par"+ids).html(new_phase);                                               
                                               var _page = obj.new_parent.split(" : ");
                                               $("#div_par_page"+ids).html(_page[1]);   
                                               var page_url = 'https://'+"<?php echo $wgServerName.$this->ArticlePath;?>"+'/'+_page[1];
                                               $("#div_par_page"+ids).attr("href",page_url); 
                                            }else{
                                               alert('Internal Server Error');
                                            }                               
                                        }
                                });                                                       
                        });

                        $('.editparent_2').click(function(){                                
                                var ids=$(this).attr('id').replace('div_par2','');	                                                                                                 
                                $(this).editable('<?php echo $gantt_api;?>', {                                     
                                    loadurl : '<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=get_data&local=<?php echo $this->local;?>&2ndtheme',                                        
                                    type    : 'select',
                                    submit  : 'OK',
                                    cancel  : 'Cancel',
                                    id      : 'elementid',                                    
                                    submitdata : {itask_id: ids ,aluser:"<?php echo $aluser;?>",apikey:"<?php echo $apikey;?>",type:"update_parent", ndtheme:"true"},
                                    indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                                    tooltip   : 'Click to Edit Parent Project',
                                        callback  : function(data, settings){              
                                            var obj = JSON.parse(data);
                                            //console.log(obj);
                                            if (obj.success==true) {
                                               //$("#div_par2"+ids).html(obj.parent_id);
                                               new_phase = (obj.new_parent_)? obj.new_parent_ : "None";
                                               $("#div_par2"+ids).html(new_phase);                                               
                                               var _page = obj.new_parent.split(" : ");
                                               $("#div_par_page2"+ids).html(_page[1]);   
                                               var page_url = 'https://'+"<?php echo $wgServerName.$this->ArticlePath;?>"+'/'+_page[1];
                                               $("#div_par_page2"+ids).attr("href",page_url); 
                                            }else{
                                               alert('Internal Server Error');
                                            }                               
                                        }
                                });                                                       
                        });
                        
                        $('.edit').click(function(){
				var ids=$(this).attr('id').replace('div_own','');				
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {                                
					data   : "{'<?php echo implode('\',\'',$l_owner);?>'}",
					type   : 'select',
					submit : 'OK',
					id   : 'elementid',
					name : 'newvalue',					
                                        submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
					indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
					tooltip   : 'Click to edit ...',
					callback  : function(data, settings){
						$("#div_own1"+ids).html("<div id='div_own1"+ids+"' class='rsltown1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
						$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
					}
				});
			});        

                        $('.edit_1').click(function(){
				var ids=$(this).attr('id').replace('div_own','');				
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {                                
					data   : "{'<?php echo implode('\',\'',$l_owner_1);?>'}",
					type   : 'select',
					submit : 'OK',
					id   : 'elementid',
					name : 'newvalue',					
                                        submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
					indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
					tooltip   : 'Click to edit ...',
					callback  : function(data, settings){
						$("#div_own1"+ids).html("<div id='div_own1"+ids+"' class='rsltown1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
						$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
					}
				});
			});                                      

                        $('.editstart_date').click(function(){  
                                var ids=$(this).attr('id').replace('div_str','');            	                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
                                        type   : 'datepicker',
                                            datepicker : {                                            
                                            dateFormat: 'dd-MM-yy'},                                     
                			id   : 'elementid',
                			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                                        tooltip   : 'Click to edit ...',
                                        callback  : function(data, settings){
                                                     var bfr=this.revert;
							$("#div_str1"+ids).html("<form method='post' name='form'><div id='div_str2"+ids+"' class='rsltstr2'>Depend ID:<input id='depend' name='depend' class='dependMark' size='7'/><input type='submit' value='Submit' class='oke'/></div></form>");							
                                        		$(".oke").click(function(e) {
                                                		var depend = $("#depend").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";                                                                   
                                                                    dbcon = encodeURIComponent(dbcon0);
                                                		var dataString = 'depend='+ depend+'&id='+ids+'&dbcon='+dbcon;                                                                
                                                		$.ajax({
                                                        		type: "POST",
                                                        		//url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/Views/dependIbug.php",
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=dependIbug&local=<?php echo $this->local;?>",                                                                        
                                                        		data: dataString,
                                                        		success: function(){
                                                                            $("#div_str1"+ids).html("<div id='div_str2"+ids+"' class='rsltstr2'><b>Depend ID:"+depend+"</b><br/><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+bfr+"</i><br></div>");}                                                                                                                   
                                                                          //$("#div_str1"+ids).html("<div id='div_str2"+ids+"' class='rsltstr2'><b>Depend ID:"+depend+"</b></div>");}
                                                		});
                                                		return false;
                                        		});    
                                                $("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");						
                			}                                  
            			});
			});
                
                        $('.edittarget_date').click(function(){  
                                var ids=$(this).attr('id').replace('div_tar','');            		                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {    
                                        type   : 'datepicker',
                                            datepicker : {                                            
                                            dateFormat: 'dd-MM-yy'},                                     
                			id   : 'elementid',
                			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},                                        
                			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                                        tooltip   : 'Click to edit ...',
                                        callback  : function(data, settings){                                              
                                        $("#div_tar1"+ids).html("<div id='div_tar1"+ids+"' class='rslttarget1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");                                                                               
                    			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
                                         }     
            			});
			});
                        
			$('.editperc').editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {                            
                        	type   : 'textarea',
                        	submit : 'OK',
                        	id   : 'elementid',
                        	name : 'newvalue',
                        	indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                        	tooltip   : 'Click to edit...'
                	});
		
			$('.edittitle').click(function(){
            			var ids=$(this).attr('id').replace('div_ttl','');            			
				$(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
                			type   : 'textarea',
                			submit : 'OK',
                			id   : 'elementid',
                			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
                    				$("#div_tle1"+ids).html("<div id='div_tle1"+ids+"' class='rslttitle1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                    				$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");                                                
                			}
            			});
			});

			$('.editpriority').click(function(){
				var ids=$(this).attr('id').replace('div_pry','');	                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {    
					data   : "{'<?php echo implode('\',\'',$l_prior);?>'}",
                			type   : 'select',
                			submit : 'OK',
                			id   : 'elementid',
                			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                			tooltip   : 'Click to edit...',
					callback  : function(data, settings){                                                
                                                //var n = data.match(/<span id='(.*?)'>(.*?)<\/span>/g);   
                                                var n = /<span id=\'(.*)\' priority=\'(.*)\' limit_itask=\'(.*)\' tot_itask=\'(.*)\'>(.*)<\/span>/.exec(data);                                                   
                                                console.log(n);
                                                if (n) {
                                                    if (n[1]=="max_limit_itask") {  
                                                    alert('Change to '+n[2]+' Priority not allowed !\nOwner this iTask has more than '+n[3]+' '+n[2]+' iTask  (Total iTask '+n[2]+' : '+n[4]+' iTasks)');                                                                                                        
                                                    }else{
                                                    alert('iTask id : '+ids+' has been changed to High priority \nOwner this iTask has more than '+n[3]+' '+n[2]+' iTask  (Total iTask '+n[2]+' : '+n[4]+' iTasks) \nOldest iTask (id : '+n[1]+') has been changed to Medium priority !');    
                                                    }
                                                }else{
                                                    $("#div_pri1"+ids).html("<div id='div_pri1"+ids+"' class='rsltprior1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                                                    $("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");                                                    
                                                    $("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
                                                }
                			}
            			});
			});
                                                                        
			$('.edittype').editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {                            
                        	type   : 'select',
                        	submit : 'OK',
                        	id   : 'elementid',
                        	name : 'newvalue',
				submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                        	indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                        	tooltip   : 'Click to edit...'
                	});

			$('.editcoor').click(function(){
            			var ids=$(this).attr('id').replace('div_coo','');            			
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {                                        
					data   : "{'<?php echo implode('\',\'',$l_coor);?>'}",
                			type   : 'select',
                			submit : 'OK',
                			id   : 'elementid',
                			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
                    				$("#div_corr1"+ids).html("<div id='div_corr1"+ids+"' class='rsltcoor1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                    				$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
                			}
            			});
			});
		
			$('.editapp').click(function(){
                		var ids=$(this).attr('id').replace('div_app','');                		
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_app);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
                        			$("#div_apr1"+ids).html("<div id='div_apr1"+ids+"' class='rsltapp1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
                    			}
                		});
			});

			$('.editsts').click(function(){
                		var ids=$(this).attr('id').replace('div_sts','');                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_status);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
						if(data==='iTask Pending Development'){
							var bfr=this.revert;
							$("#div_sttus1"+ids).html("<form method='post' name='form'><div id='div_sttus2"+ids+"' class='rsltsts2'><textarea id='reason' name='reason' class='reasonMark'>Reason</textarea><input type='submit' value='Submit' class='oke'/></div></form>");
							$('textarea.reasonMark').focus(function() {
                                                		$('textarea.reasonMark').css('color','black');

                                                		if (this.value.trim() === 'Reason') {
                                                        		this.value = '';
                                                		}
                                        		});

                                        		$(".oke").click(function(e) {
                                                		var reason = $("#reason").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
                                                                dbcon = encodeURIComponent(dbcon0);                                                		
                                                                var dataString = 'reason='+ reason+'&id='+ids+'&dbcon='+dbcon;
                                                		$.ajax({
                                                        		type: "POST",                                                        		
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=reasonPending&local=<?php echo $this->local;?>",
                                                        		data: dataString,
                                                        		success: function(){
										$("#div_sttus1"+ids).html("<div id='div_sttus2"+ids+"' class='rsltsts2'><b>"+reason+"</b></div><div id='div_sttus1"+ids+"' class='rsltsts1'><i>"+bfr+"<br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");}                                                                                
                                                		});
                                                		return false;
                                        		});                                                                                                               
						}else                                                    
                        			$("#div_sttus1"+ids).html("<div id='div_sttus1"+ids+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");                                                                                                                                                            
                                                    var jArray = <?php echo json_encode($arrColour); ?>;                                                    
                                                    $("#td_sts"+ids).css("background-color", jArray[data]);                                                                   
                                                }                                            
                		});
			});

			$('.editsts_0').click(function(){
                		var ids=$(this).attr('id').replace('div_sts','');                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_status_0);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
						if(data==='iTask Pending Development'){
							var bfr=this.revert;
							$("#div_sttus1"+ids).html("<form method='post' name='form'><div id='div_sttus2"+ids+"' class='rsltsts2'><textarea id='reason' name='reason' class='reasonMark'>Reason</textarea><input type='submit' value='Submit' class='oke'/></div></form>");
							$('textarea.reasonMark').focus(function() {
                                                		$('textarea.reasonMark').css('color','black');

                                                		if (this.value.trim() === 'Reason') {
                                                        		this.value = '';
                                                		}
                                        		});

                                        		$(".oke").click(function(e) {
                                                		var reason = $("#reason").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
                                                                dbcon = encodeURIComponent(dbcon0);
                                                		//var dataString = 'reason='+ reason+'&id='+ids+'&dbcon=<?php echo $this->dbcon; ?>';             
                                                                var dataString = 'reason='+ reason+'&id='+ids+'&dbcon='+dbcon;
                                                		$.ajax({
                                                        		type: "POST",
                                                        		//url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/Views/reasonPending.php",
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=reasonPending&local=<?php echo $this->local;?>",
                                                        		data: dataString,
                                                        		success: function(){
										$("#div_sttus1"+ids).html("<div id='div_sttus2"+ids+"' class='rsltsts2'><b>"+reason+"</b></div><div id='div_sttus1"+ids+"' class='rsltsts1'><i>"+bfr+"<br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");}                                                                                
                                                		});
                                                		return false;
                                        		});                                                                                                               
						}else                                                    
                        			$("#div_sttus1"+ids).html("<div id='div_sttus1"+ids+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
                                                    var jArray = <?php echo json_encode($arrColour);?>;                                                                                                        
                                                    $("#td_sts"+ids).css("background-color", jArray[data]);
                                                }                                            
                		});
			});                                                
                                         
                        $('.editstsNew1').click(function(){                                
                		var ids=$(this).attr('id').replace('div_sts','');                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_statusN[1]);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
						if(data==='iTask Pending Development'){
							var bfr=this.revert;
							$("#div_sttus1"+ids).html("<form method='post' name='form'><div id='div_sttus2"+ids+"' class='rsltsts2'><textarea id='reason' name='reason' class='reasonMark'>Reason</textarea><input type='submit' value='Submit' class='oke'/></div></form>");
							$('textarea.reasonMark').focus(function() {
                                                		$('textarea.reasonMark').css('color','black');

                                                		if (this.value.trim() === 'Reason') {
                                                        		this.value = '';
                                                		}
                                        		});

                                        		$(".oke").click(function(e) {
                                                		var reason = $("#reason").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
                                                                dbcon = encodeURIComponent(dbcon0);                                                		
                                                                var dataString = 'reason='+ reason+'&id='+ids+'&dbcon='+dbcon;
                                                		$.ajax({
                                                        		type: "POST",                                                        		
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=reasonPending&local=<?php echo $this->local;?>",
                                                        		data: dataString,
                                                        		success: function(){
										$("#div_sttus1"+ids).html("<div id='div_sttus2"+ids+"' class='rsltsts2'><b>"+reason+"</b></div><div id='div_sttus1"+ids+"' class='rsltsts1'><i>"+bfr+"<br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");}                                                                                
                                                		});
                                                		return false;
                                        		});                                                                                                               
						}else                                                    
                        			$("#div_sttus1"+ids).html("<div id='div_sttus1"+ids+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");                                                                                                                                                            
                                                    var jArray = <?php echo json_encode($arrColour); ?>;                                                    
                                                    $("#td_sts"+ids).css("background-color", jArray[data]);                                                                   
                                                }                                            
                		});
			});
                     
                        $('.editstsNew2').click(function(){                                
                		var ids=$(this).attr('id').replace('div_sts','');                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_statusN[2]);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
						if(data==='iTask Pending Development'){
							var bfr=this.revert;
							$("#div_sttus1"+ids).html("<form method='post' name='form'><div id='div_sttus2"+ids+"' class='rsltsts2'><textarea id='reason' name='reason' class='reasonMark'>Reason</textarea><input type='submit' value='Submit' class='oke'/></div></form>");
							$('textarea.reasonMark').focus(function() {
                                                		$('textarea.reasonMark').css('color','black');

                                                		if (this.value.trim() === 'Reason') {
                                                        		this.value = '';
                                                		}
                                        		});

                                        		$(".oke").click(function(e) {
                                                		var reason = $("#reason").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
                                                                dbcon = encodeURIComponent(dbcon0);                                                		
                                                                var dataString = 'reason='+ reason+'&id='+ids+'&dbcon='+dbcon;
                                                		$.ajax({
                                                        		type: "POST",                                                        		
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=reasonPending&local=<?php echo $this->local;?>",
                                                        		data: dataString,
                                                        		success: function(){
										$("#div_sttus1"+ids).html("<div id='div_sttus2"+ids+"' class='rsltsts2'><b>"+reason+"</b></div><div id='div_sttus1"+ids+"' class='rsltsts1'><i>"+bfr+"<br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");}                                                                                
                                                		});
                                                		return false;
                                        		});                                                                                                               
						}else                                                    
                        			$("#div_sttus1"+ids).html("<div id='div_sttus1"+ids+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");                                                                                                                                                            
                                                    var jArray = <?php echo json_encode($arrColour); ?>;                                                    
                                                    $("#td_sts"+ids).css("background-color", jArray[data]);                                                                   
                                                }                                            
                		});
			});
                        
                        $('.editstsNew3').click(function(){                                
                		var ids=$(this).attr('id').replace('div_sts','');                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_statusN[3]);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
						if(data==='iTask Pending Development'){
							var bfr=this.revert;
							$("#div_sttus1"+ids).html("<form method='post' name='form'><div id='div_sttus2"+ids+"' class='rsltsts2'><textarea id='reason' name='reason' class='reasonMark'>Reason</textarea><input type='submit' value='Submit' class='oke'/></div></form>");
							$('textarea.reasonMark').focus(function() {
                                                		$('textarea.reasonMark').css('color','black');

                                                		if (this.value.trim() === 'Reason') {
                                                        		this.value = '';
                                                		}
                                        		});

                                        		$(".oke").click(function(e) {
                                                		var reason = $("#reason").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
                                                                dbcon = encodeURIComponent(dbcon0);                                                		
                                                                var dataString = 'reason='+ reason+'&id='+ids+'&dbcon='+dbcon;
                                                		$.ajax({
                                                        		type: "POST",                                                        		
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=reasonPending&local=<?php echo $this->local;?>",
                                                        		data: dataString,
                                                        		success: function(){
										$("#div_sttus1"+ids).html("<div id='div_sttus2"+ids+"' class='rsltsts2'><b>"+reason+"</b></div><div id='div_sttus1"+ids+"' class='rsltsts1'><i>"+bfr+"<br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");}                                                                                
                                                		});
                                                		return false;
                                        		});                                                                                                               
						}else                                                    
                        			$("#div_sttus1"+ids).html("<div id='div_sttus1"+ids+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");                                                                                                                                                            
                                                    var jArray = <?php echo json_encode($arrColour); ?>;                                                    
                                                    $("#td_sts"+ids).css("background-color", jArray[data]);                                                                   
                                                }                                            
                		});
			});
                        
                        $('.editstsNew4').click(function(){                                
                		var ids=$(this).attr('id').replace('div_sts','');                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_statusN[4]);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
						if(data==='iTask Pending Development'){
							var bfr=this.revert;
							$("#div_sttus1"+ids).html("<form method='post' name='form'><div id='div_sttus2"+ids+"' class='rsltsts2'><textarea id='reason' name='reason' class='reasonMark'>Reason</textarea><input type='submit' value='Submit' class='oke'/></div></form>");
							$('textarea.reasonMark').focus(function() {
                                                		$('textarea.reasonMark').css('color','black');

                                                		if (this.value.trim() === 'Reason') {
                                                        		this.value = '';
                                                		}
                                        		});

                                        		$(".oke").click(function(e) {
                                                		var reason = $("#reason").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
                                                                dbcon = encodeURIComponent(dbcon0);                                                		
                                                                var dataString = 'reason='+ reason+'&id='+ids+'&dbcon='+dbcon;
                                                		$.ajax({
                                                        		type: "POST",                                                        		
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=reasonPending&local=<?php echo $this->local;?>",
                                                        		data: dataString,
                                                        		success: function(){
										$("#div_sttus1"+ids).html("<div id='div_sttus2"+ids+"' class='rsltsts2'><b>"+reason+"</b></div><div id='div_sttus1"+ids+"' class='rsltsts1'><i>"+bfr+"<br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");}                                                                                
                                                		});
                                                		return false;
                                        		});                                                                                                               
						}else                                                    
                        			$("#div_sttus1"+ids).html("<div id='div_sttus1"+ids+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");                                                                                                                                                            
                                                    var jArray = <?php echo json_encode($arrColour); ?>;                                                    
                                                    $("#td_sts"+ids).css("background-color", jArray[data]);                                                                   
                                                }                                            
                		});
			});
                               
                        $('.editstsNew5').click(function(){                                
                		var ids=$(this).attr('id').replace('div_sts','');                                
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
					data   : "{'<?php echo implode('\',\'',$l_statusN[5]);?>'}",
                    			type   : 'select',
                    			submit : 'OK',
                    			id   : 'elementid',
                    			name : 'newvalue',
					submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                    			indicator : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                    			tooltip   : 'Click to edit...',
					callback  : function(data, settings){
						if(data==='iTask Pending Development'){
							var bfr=this.revert;
							$("#div_sttus1"+ids).html("<form method='post' name='form'><div id='div_sttus2"+ids+"' class='rsltsts2'><textarea id='reason' name='reason' class='reasonMark'>Reason</textarea><input type='submit' value='Submit' class='oke'/></div></form>");
							$('textarea.reasonMark').focus(function() {
                                                		$('textarea.reasonMark').css('color','black');

                                                		if (this.value.trim() === 'Reason') {
                                                        		this.value = '';
                                                		}
                                        		});

                                        		$(".oke").click(function(e) {
                                                		var reason = $("#reason").val();
                                                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
                                                                dbcon = encodeURIComponent(dbcon0);                                                		
                                                                var dataString = 'reason='+ reason+'&id='+ids+'&dbcon='+dbcon;
                                                		$.ajax({
                                                        		type: "POST",                                                        		
                                                                        url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=reasonPending&local=<?php echo $this->local;?>",
                                                        		data: dataString,
                                                        		success: function(){
										$("#div_sttus1"+ids).html("<div id='div_sttus2"+ids+"' class='rsltsts2'><b>"+reason+"</b></div><div id='div_sttus1"+ids+"' class='rsltsts1'><i>"+bfr+"<br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");}                                                                                
                                                		});
                                                		return false;
                                        		});                                                                                                               
						}else                                                    
                        			$("#div_sttus1"+ids).html("<div id='div_sttus1"+ids+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                        			$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");                                                                                                                                                            
                                                    var jArray = <?php echo json_encode($arrColour); ?>;                                                    
                                                    $("#td_sts"+ids).css("background-color", jArray[data]);                                                                   
                                                }                                            
                		});
			});
                        
			$('.editsections').click(function(){
            			var ids=$(this).attr('id').replace('div_sct','');            			
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
                			data    : "{'<?php echo implode('\',\'',$l_thme);?>'}",
                			type    : 'select',
                			submit  : 'OK',
                			id      : 'elementid',
                			name    : 'newvalue',
                			submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                			indicator  : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                			tooltip   : 'Click to edit...',
                			callback  : function(data, settings){
                    				$("#div_sct1"+ids).html("<div id='div_sct1"+ids+"' class='rsltsct1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                    				$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
                			}
            			});
        		});

                        $('.editsections_2').click(function(){
            			var ids=$(this).attr('id').replace('div_sct_2','');            			
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=save&local=<?php echo $this->local;?>', {
                			data    : "{'<?php echo implode('\',\'',$l_thme_2);?>'}",
                			type    : 'select',
                			submit  : 'OK',
                			id      : 'elementid',
                			name    : 'newvalue',
                			submitdata : {foo: "<?php echo $this->getUsrName; ?>",path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>"},
                			indicator  : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                			tooltip   : 'Click to edit...',
                			callback  : function(data, settings){
                    				$("#div_sct1_2"+ids).html("<div id='div_sct1_2"+ids+"' class='rsltsct1_2'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?><br>"+this.revert+"</i><br></div>");
                    				$("#div_due"+ids).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+ids).html(ajax_(ids)+"<br>");
                			}
            			});
        		});

			//hide button
                	$(".commentMark").focus(function(e)
                	{
                        	var ids =  $(this).attr('id').replace('commentMark-','');
                        	$(this).animate({"min-height": "48.2px",},"fast" );
                        	if (ids===ids)
                                $("#SubmitCmtWorking-"+ids).slideDown("fast");    
                                $("#SubmitCmtFeedback-"+ids).slideDown("fast");     
                        	$("#SubmitComment-"+ids).slideDown("fast");
                                $("#SubmitCmtPendingApprove-"+ids).slideDown("fast"); 
                                $("#SubmitCmtApprove-"+ids).slideDown("fast");     
                                $("#SubmitCmtPending-"+ids).slideDown("fast"); 
                                $("#SubmitCmtCancel-"+ids).slideDown("fast"); 
                        	$("#cancelComment-"+ids).slideDown("fast");
                        	return false;
                	});
                	$(".cancel").click(function(e)
                	{
                        	var idc =  $(this).attr('id').replace('cancelComment-','');
                        	$("#commentMark-"+idc).animate({"height": "20px","min-height": "20px"}, "fast" );
                        	if (idc===idc)
                                        $("#SubmitCmtWorking-"+idc).slideUp("fast");
                                        $("#SubmitCmtFeedback-"+idc).slideUp("fast");
                        		$("#SubmitComment-"+idc).slideUp("fast");
                                        $("#SubmitCmtPendingApprove-"+idc).slideUp("fast");
                                        $("#SubmitCmtApprove-"+idc).slideUp("fast");
                                        $("#SubmitCmtPending-"+idc).slideUp("fast");
                                        $("#SubmitCmtCancel-"+idc).slideUp("fast");
                        		$("#cancelComment-"+idc).slideUp("fast");
                        		$('textarea#commentMark-'+idc).val('Comment...').css('color','grey');
                        	return false;
                	});
	
                        //SubmitComment+Working			                        
                        $('a.cmtworking').click(function(){                           
				var nxt = "<?php echo $dttoday; ?>";
				var getpID =  $(this).parent().attr('id').replace('commentBox-','');	
				var comment_text = $("#commentMark-"+getpID).val();
				var comment_text_new = comment_text.replace(/\n/gi,"<br />");
				var comment_text = comment_text_new;
                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
				data  = encodeURIComponent(comment_text);
                                dbcon = encodeURIComponent(dbcon0);                                    
                                    var path0 =  "<?php echo $this->path; ?>";
                                    path = encodeURIComponent(path0);
                                        var smtp0 =  "<?php echo $this->smtp; ?>";
                                        smtp = encodeURIComponent(smtp0);
				var user_name = $("#user_name-"+getpID).val();
				if(comment_text !== "Comment..." && comment_text !== null)
				{	                                   
                                    var dataString = 'status=working&comment_text='+data+'&post_id='+getpID+'&user_name='+user_name+'&nxt='+nxt+'&dbcon='+dbcon+'&path='+path+'&smtp='+smtp;
                                    $.ajax({
                                            type: "POST",                                            
                                            url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=add_comment&local=<?php echo $this->local;?>",
                                            data: dataString,
                                            success: function(response){
                                                $('#CommentPosted'+getpID).append($(response).fadeIn('slow'));
                                                $("#div_due"+getpID).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>'title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
                                                //$("#div_nxtDate"+getpID).html("<?php echo $dttoday; ?><br>");
                                                $("#div_nxtDate"+getpID).html(ajax_(getpID)+"<br>");                                                
                                                $("#commentMark-"+getpID).val("Comment...");			
                                                $('#CommentSend'+getpID);                                                                                                      
                                                    var jArray = <?php echo json_encode($arrColour);?>;                                                                                                        
                                                    $("#td_sts"+getpID).css("background-color", jArray["iTask Working"]);
                                                    $("#td_sts"+getpID).css("background-color", "<?php echo $arrColour['iTask Working']; ?>") ;
                                                    $("#div_sts"+getpID).html("iTask Working");
                                                    $("#div_sttus1"+getpID).html("<div id='div_sttus1"+getpID+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");                                                    
                                                    var match = response.match(/tot_comment=\"([^"]*)\"/);                                                                  
                                                    document.getElementById('displayText'+getpID).innerHTML = "Show "+match[1]+" Comments"; 
                                            }                                                                                
                                    });                                   
				}
			
			});	
    	                   
                        //SubmitComment+Feedback
			$('a.cmtfeedback').click(function(){
				var nxt = "<?php echo $dttoday; ?>";
				var getpID =  $(this).parent().attr('id').replace('commentBox-','');	
				var comment_text = $("#commentMark-"+getpID).val();
				var comment_text_new = comment_text.replace(/\n/gi,"<br />");
				var comment_text = comment_text_new;
                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
				data  = encodeURIComponent(comment_text);
                                dbcon = encodeURIComponent(dbcon0);                                    
                                    var path0 =  "<?php echo $this->path; ?>";
                                    path = encodeURIComponent(path0);
                                        var smtp0 =  "<?php echo $this->smtp; ?>";
                                        smtp = encodeURIComponent(smtp0);
				var user_name = $("#user_name-"+getpID).val();
				if(comment_text !== "Comment..." && comment_text !== null)
				{	                                   
                                    var dataString = 'status=feedback&comment_text='+data+'&post_id='+getpID+'&user_name='+user_name+'&nxt='+nxt+'&dbcon='+dbcon+'&path='+path+'&smtp='+smtp;
                                    $.ajax({
                                            type: "POST",                                            
                                            url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=add_comment&local=<?php echo $this->local;?>",
                                            data: dataString,
                                            success: function(response){
                                                $('#CommentPosted'+getpID).append($(response).fadeIn('slow'));
                                                $("#div_due"+getpID).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>'title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
                                                $("#div_nxtDate"+getpID).html(ajax_(getpID)+"<br>");
                                                $("#commentMark-"+getpID).val("Comment...");			
                                                $('#CommentSend'+getpID);                                                   
                                                    var jArray = <?php echo json_encode($arrColour);?>;                                                                                                        
                                                    $("#td_sts"+getpID).css("background-color", jArray["iTask Feedback"]);
                                                    $("#div_sts"+getpID).html("iTask Feedback");
                                                    $("#div_sttus1"+getpID).html("<div id='div_sttus1"+getpID+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");                                                                                                    
                                                    var match = response.match(/tot_comment=\"([^"]*)\"/);                                                                  
                                                    document.getElementById('displayText'+getpID).innerHTML = "Show "+match[1]+" Comments"; 
                                            }                                                                                
                                    });                                   
				}
			
			});	
                     
			//SubmitComment
			$('a.comment').click(function(){
				var nxt = "<?php echo $dttoday; ?>";
				var getpID =  $(this).parent().attr('id').replace('commentBox-','');	
				var comment_text = $("#commentMark-"+getpID).val();
				var comment_text_new = comment_text.replace(/\n/gi,"<br />");
				var comment_text = comment_text_new;                               
				data  = encodeURIComponent(comment_text);                                
				var user_name = $("#user_name-"+getpID).val();
				if(comment_text !== "Comment..." && comment_text !== null)
				{					
                                        $.post("<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=add_comment&local=<?php echo $this->local;?>&comment_text="+data+"&post_id="+getpID+"&user_name="+user_name+"&nxt="+nxt, {                                        
					}, function(response){
						$('#CommentPosted'+getpID).append($(response).fadeIn('slow'));
						$("#div_due"+getpID).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>'title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
						$("#div_nxtDate"+getpID).html(ajax_(getpID)+"<br>");
						$("#commentMark-"+getpID).val("Comment...");			
                                                $('#CommentSend'+getpID);                                                
                                                var match = response.match(/tot_comment=\"([^"]*)\"/);                                                                  
                                                document.getElementById('displayText'+getpID).innerHTML = "Show "+match[1]+" Comments"; 
					});
				}
			
			});	
                        
                        //SubmitComment+PendingApprove
			$('a.cmtpendingapprove').click(function(){
				var nxt = "<?php echo $dttoday; ?>";
				var getpID =  $(this).parent().attr('id').replace('commentBox-','');	
				var comment_text = $("#commentMark-"+getpID).val();
				var comment_text_new = comment_text.replace(/\n/gi,"<br />");
				var comment_text = comment_text_new;
                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
				data  = encodeURIComponent(comment_text);
                                dbcon = encodeURIComponent(dbcon0);                                    
                                    var path0 =  "<?php echo $this->path; ?>";
                                    path = encodeURIComponent(path0);
                                        var smtp0 =  "<?php echo $this->smtp; ?>";
                                        smtp = encodeURIComponent(smtp0);
				var user_name = $("#user_name-"+getpID).val();                                                                
                                if(comment_text !== "Comment..." && comment_text !== null)
                                {	                                     
                                    var dataString = 'status=pendingapprove&comment_text='+data+'&post_id='+getpID+'&user_name='+user_name+'&nxt='+nxt+'&dbcon='+dbcon+'&path='+path+'&smtp='+smtp;
                                    $.ajax({
                                            type: "POST",                                            
                                            url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=add_comment&local=<?php echo $this->local;?>",
                                            data: dataString,
                                            success: function(response){
                                                $('#CommentPosted'+getpID).append($(response).fadeIn('slow'));
                                                $("#div_due"+getpID).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>'title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
                                                $("#div_nxtDate"+getpID).html(ajax_(getpID)+"<br>");
                                                $("#commentMark-"+getpID).val("Comment...");			
                                                $('#CommentSend'+getpID);                                                   
                                                    var jArray = <?php echo json_encode($arrColour);?>;                                                                                                        
                                                    $("#td_sts"+getpID).css("background-color", jArray["iTask Pending Approval"]);
                                                    $("#div_sts"+getpID).html("iTask Pending Approval");
                                                    $("#div_sttus1"+getpID).html("<div id='div_sttus1"+getpID+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");                                                                                                    
                                                    var match = response.match(/tot_comment=\"([^"]*)\"/);                                                                  
                                                    document.getElementById('displayText'+getpID).innerHTML = "Show "+match[1]+" Comments"; 
                                            }                                                                                
                                    });                                   				
                                 }
			});
                        
                        //SubmitComment+Approve
			$('a.cmtapprove').click(function(){
				var nxt = "<?php echo $dttoday; ?>";
				var getpID =  $(this).parent().attr('id').replace('commentBox-','');	
				var comment_text = $("#commentMark-"+getpID).val();
				var comment_text_new = comment_text.replace(/\n/gi,"<br />");
				var comment_text = comment_text_new;
                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
				data  = encodeURIComponent(comment_text);
                                dbcon = encodeURIComponent(dbcon0);                                    
                                    var path0 =  "<?php echo $this->path; ?>";
                                    path = encodeURIComponent(path0);
                                        var smtp0 =  "<?php echo $this->smtp; ?>";
                                        smtp = encodeURIComponent(smtp0);
				var user_name = $("#user_name-"+getpID).val();                                
                                if(comment_text == "Comment..." || comment_text == null)
                                {	
                                   comment_text ="";   
                                   data  = encodeURIComponent(comment_text);
                                }     
                                    var dataString = 'status=approve&comment_text='+data+'&post_id='+getpID+'&user_name='+user_name+'&nxt='+nxt+'&dbcon='+dbcon+'&path='+path+'&smtp='+smtp;
                                    $.ajax({
                                            type: "POST",                                            
                                            url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=add_comment&local=<?php echo $this->local;?>",
                                            data: dataString,
                                            success: function(response){
                                                $('#CommentPosted'+getpID).append($(response).fadeIn('slow'));
                                                $("#div_due"+getpID).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>'title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");                                                
                                                $("#commentMark-"+getpID).val("Comment...");			
                                                $('#CommentSend'+getpID);                                                   
                                                    var jArray = <?php echo json_encode($arrColour);?>;                                                                                                        
                                                    $("#td_sts"+getpID).css("background-color", jArray["iTask Approved"]);
                                                    $("#div_sts"+getpID).html("iTask Approved");
                                                    $("#div_sttus1"+getpID).html("<div id='div_sttus1"+getpID+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");                                                                                                    
                                                    var match = response.match(/tot_comment=\"([^"]*)\"/);                                                                  
                                                    document.getElementById('displayText'+getpID).innerHTML = "Show "+match[1]+" Comments"; 
                                            }                                                                                
                                    });                                   				
			
			});
                        
                        //SubmitComment+Pending
			$('a.cmtpending').click(function(){
				var nxt = "<?php echo $dttoday; ?>";
				var getpID =  $(this).parent().attr('id').replace('commentBox-','');	
				var comment_text = $("#commentMark-"+getpID).val();
				var comment_text_new = comment_text.replace(/\n/gi,"<br />");
				var comment_text = comment_text_new;
                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
				data  = encodeURIComponent(comment_text);
                                dbcon = encodeURIComponent(dbcon0);                                    
                                    var path0 =  "<?php echo $this->path; ?>";
                                    path = encodeURIComponent(path0);
                                        var smtp0 =  "<?php echo $this->smtp; ?>";
                                        smtp = encodeURIComponent(smtp0);
				var user_name = $("#user_name-"+getpID).val();                                                                                                        
                                if(comment_text !== "Comment..." && comment_text !== null)
				{	                                   
                                    var dataString = 'status=pending&comment_text='+data+'&post_id='+getpID+'&user_name='+user_name+'&nxt='+nxt+'&dbcon='+dbcon+'&path='+path+'&smtp='+smtp;
                                    $.ajax({
                                            type: "POST",                                            
                                            url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=add_comment&local=<?php echo $this->local;?>",
                                            data: dataString,
                                            success: function(response){
                                                $('#CommentPosted'+getpID).append($(response).fadeIn('slow'));
                                                $("#div_due"+getpID).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>'title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
                                                $("#div_nxtDate"+getpID).html(ajax_(getpID)+"<br>");
                                                $("#commentMark-"+getpID).val("Comment...");			
                                                $('#CommentSend'+getpID);                                                   
                                                    var jArray = <?php echo json_encode($arrColour);?>;                                                                                                        
                                                    $("#td_sts"+getpID).css("background-color", jArray["iTask Pending Development"]);
                                                    $("#div_sts"+getpID).html("iTask Pending Development");
                                                    $("#div_sttus1"+getpID).html("<div id='div_sttus1"+getpID+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");                                                                                                    
                                                    var match = response.match(/tot_comment=\"([^"]*)\"/);                                                                  
                                                    document.getElementById('displayText'+getpID).innerHTML = "Show "+match[1]+" Comments"; 
                                            }                                                                                
                                    });                                   
				}                                       			
			});
		                   
                        //SubmitComment+Cancel iTask
			$('a.cmtcancel').click(function(){
				var nxt = "<?php echo $dttoday; ?>";
				var getpID =  $(this).parent().attr('id').replace('commentBox-','');	
				var comment_text = $("#commentMark-"+getpID).val();
				var comment_text_new = comment_text.replace(/\n/gi,"<br />");
				var comment_text = comment_text_new;
                                var dbcon0 =  "<?php echo $this->dbcon; ?>";
				data  = encodeURIComponent(comment_text);
                                dbcon = encodeURIComponent(dbcon0);                                    
                                    var path0 =  "<?php echo $this->path; ?>";
                                    path = encodeURIComponent(path0);
                                        var smtp0 =  "<?php echo $this->smtp; ?>";
                                        smtp = encodeURIComponent(smtp0);
				var user_name = $("#user_name-"+getpID).val();
				if(comment_text !== "Comment..." && comment_text !== null)
				{	                                   
                                    var dataString = 'status=cancel&comment_text='+data+'&post_id='+getpID+'&user_name='+user_name+'&nxt='+nxt+'&dbcon='+dbcon+'&path='+path+'&smtp='+smtp;
                                    $.ajax({
                                            type: "POST",                                            
                                            url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=add_comment&local=<?php echo $this->local;?>",
                                            data: dataString,
                                            success: function(response){
                                                $('#CommentPosted'+getpID).append($(response).fadeIn('slow'));
                                                $("#div_due"+getpID).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>'title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");                                                
                                                $("#commentMark-"+getpID).val("Comment...");			
                                                $('#CommentSend'+getpID);                                                   
                                                    var jArray = <?php echo json_encode($arrColour);?>;                                                                                                        
                                                    $("#td_sts"+getpID).css("background-color", jArray["iTask Cancelled"]);
                                                    $("#div_sts"+getpID).html("iTask Cancelled");
                                                    $("#div_sttus1"+getpID).html("<div id='div_sttus1"+getpID+"' class='rsltsts1'><i>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User: <?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a><br>on <?php echo $dttoday; ?></i><br></div>");                                                                                                    
                                                    var match = response.match(/tot_comment=\"([^"]*)\"/);                                                                  
                                                    document.getElementById('displayText'+getpID).innerHTML = "Show "+match[1]+" Comments"; 
                                            }                                                                                
                                    });                                   
				}
			
			});	
                                   
			//deleteComment
			//$('a.c_delete').livequery("click", function(e){
                        $('a.c_delete_old').click(function(e){                                  
				var nxt = "<?php echo $dttoday; ?>";
				if(confirm('Are you sure you want to delete this comment?')===false)
				return false;	
				e.preventDefault();
                                var parent  = $(this).parent();                                
				var c_id =  $(this).attr('id').replace('CID-','');	
				var cid = $(this).attr('name').replace('c_del','');
                                var dbcon0 =  "<?php echo $this->dbcon; ?>";                                
                                dbcon = encodeURIComponent(dbcon0);
				$.ajax({
					type: 'get',					                                        
                                        url: '<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=delete_comment&local=<?php echo $this->local;?>&id='+ c_id + '&user_name=<?php echo $this->getUsrName;?>&dbcon='+dbcon,                                        
					data: '',
					beforeSend: function(){
					},
					success: function(){
						parent.fadeOut(200,function(){
						parent.remove();
						});
					}
				});
				$("#div_due"+cid).html("<?php echo $dttoday; ?><br>by <a href='<?php echo $this->ArticlePath;?>/User:<?php echo $this->getUsrName;?>' title='User:<?php echo $this->getUsrName;?>' class='new'><?php echo $this->getUsrName; ?></a>");
				$("#div_nxtDate"+cid).html("<?php echo $dttoday; ?><br>");
			});	
		
			$('textarea').elastic();									
	
	 	$('textarea.commentMark').focus(function() {
                        $('textarea.commentMark').css('color','black');

                        if (this.value.trim() === 'Comment...') {
                        	this.value = '';
            		}
		})
		.blur(function() {
                	if (this.value === '') {
                        	this.value = 'Comment...';
                        	$('textarea.commentMark').css('color','grey');
                	}
		});

		$(".view_comments").click(function() {
                	var ID = $(this).attr("id");                        
                	$.ajax({
                        	type: 'POST',
                        	//url: '<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/Views/viewajax.php',
                                url: "<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=viewajax&local=<?php echo $this->local;?>",
                        	data: "issue_id="+ ID + '&dbcon=<?php echo $this->dbcon; ?>',
                        	cache: false,
                        	success: function(html){
                                	$('#view_comments'+ID).prepend(html);
                                	$('#view'+ID).remove();
                                	$('.record-'+ID).remove();
                        	}
                	});
                	return false;
        	});
                
                 //Update with Send Email 
                $('.ActionEmail').click(function(){
            			var ids=$(this).attr('id').replace('bt_email','');
            			//$(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/Views/UpdateToEmail.php', {
                                $(this).editable('<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/ITaskTrackerAjax.php?method=UpdateToEmail&local=<?php echo $this->local;?>', {                                
                                        data    : "{'Own':'Owner','Appr':'Requester','Coord':'Coord.','OwnAppr':'Own&Req.','Sall':'All'}",
                                        type    : 'select',
                			submit  : 'SEND',
                			id      : 'elementid',                                        
                			name    : 'newvalue',
                                        submitdata : {path: "<?php echo $this->path; ?>",smtp:"<?php echo $this->smtp; ?>",dbcon:"<?php echo $this->dbcon; ?>",UpDir:"<?php echo$this->uploadDir; ?>"},                                      
                			indicator  : '<img src="<?php echo $this->ScriptPath;?>/extensions/ITaskTracker/scripts/jedit_table/indicator.gif">',
                			tooltip   : 'Click to Send Email',
                                        callback  : function(data, settings){
                    			//$("#bt_email"+ids).html("<div class='ActionEmail' id='bt_email"+ids+"'>[Send Email]</div>");
                                        }
            			});
        	});
    	
        });    
    });
   
</script>
                                        
<script>
$(document).ready(function() {
        var showChar = 150;
        var ellipsestext = "<br>...";
        var moretext = "Read More";
        var lesstext = "Less";
        $('.more').each(function() {
                var content = $(this).html();
                if(content.length > showChar) {
                        var c = content.substr(0, showChar);
                        var h = content.substr(showChar, content.length - showChar);

                        var html = c + '<span class="moreelipses">'+ellipsestext+'</span>&nbsp;<span class="morecontent"><span>' + h + '</span>&nbsp;&nbsp;<a href="" class="morelink">'+moretext+'</a></span>';

                        $(this).html(html);
                }

        });

        $(".morelink").click(function(){
                if($(this).hasClass("less")) {
                        $(this).removeClass("less");
                        $(this).html(moretext);
                } else {
                        $(this).addClass("less");
                        $(this).html(lesstext);
                }
                $(this).parent().prev().toggle();
                $(this).prev().toggle();
                return false;
        });     
        
        //Auto hide comments        
        $(".textshow").click(function(){
        var ss =  $(this).attr("id").replace("textshow","");
        var ele = document.getElementById("tesCommentPosted"+ss);
        var text = document.getElementById("displayText"+ss);
        var as= $(this).attr("value").replace("textshow","");
        $("#tesCommentPosted"+ss).toggle("slow");
        if(ele.style.display === "block") {
                ele.style.display = "none";
                text.innerHTML = "Show "+as+" Comments";
        }else {
                ele.style.display = "block";
                text.innerHTML = "Hide Comments";
        }
        });
                                         
       //Title Collapsable       
       $(".Title_show").click(function(){
               var ss =  $(this).attr("id").replace("Title_show","");
               var ele = document.getElementById("tesTitlePosted"+ss);
               var text = document.getElementById("displayTitle"+ss);
               var as= $(this).attr("value").replace("Title_show","");
               $("#tesTitlePosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Themes - Type Collapsable       
       $(".Themes_show").click(function(){
               var ss =  $(this).attr("id").replace("Themes_show","");
               var ele = document.getElementById("tesThemesPosted"+ss);
               var text = document.getElementById("displayThemes"+ss);
               var as= $(this).attr("value").replace("Themes_show","");
               $("#tesThemesPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });
       //2nd theme
       $(".Themes_show2").click(function(){
               var ss =  $(this).attr("id").replace("Themes_show2","");
               var ele = document.getElementById("tesThemesPosted2"+ss);
               var text = document.getElementById("displayThemes2"+ss);
               var as= $(this).attr("value").replace("Themes_show2","");
               $("#tesThemesPosted2"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Start Date Collapsable       
       $(".Start_show").click(function(){
               var ss =  $(this).attr("id").replace("Start_show","");
               var ele = document.getElementById("tesStartPosted"+ss);
               var text = document.getElementById("displayStart"+ss);
               var as= $(this).attr("value").replace("Start_show","");
               $("#tesStartPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Target Date Collapsable       
       $(".Target_show").click(function(){
               var ss =  $(this).attr("id").replace("Target_show","");
               var ele = document.getElementById("tesTargetPosted"+ss);
               var text = document.getElementById("displayTarget"+ss);
               var as= $(this).attr("value").replace("Target_show","");
               $("#tesTargetPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //nextStep Collapsable       
       $(".nextStep_show").click(function(){
               var ss =  $(this).attr("id").replace("nextStep_show","");
               var ele = document.getElementById("tesnextStepPosted"+ss);
               var text = document.getElementById("displaynextStep"+ss);
               var as= $(this).attr("value").replace("nextStep_show","");
               $("#tesnextStepPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Priority Collapsable       
       $(".Priority_show").click(function(){
               var ss =  $(this).attr("id").replace("Priority_show","");
               var ele = document.getElementById("tesPriorityPosted"+ss);
               var text = document.getElementById("displayPriority"+ss);
               var as= $(this).attr("value").replace("Priority_show","");
               $("#tesPriorityPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Status Collapsable       
       $(".status_show").click(function(){
               var ss =  $(this).attr("id").replace("status_show","");
               var ele = document.getElementById("tesStatusPosted"+ss);
               var text = document.getElementById("displayStatus"+ss);
               var as= $(this).attr("value").replace("status_show","");
               $("#tesStatusPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Owner Collapsable       
       $(".Owner_show").click(function(){
               var ss =  $(this).attr("id").replace("Owner_show","");
               var ele = document.getElementById("tesOwnerPosted"+ss);
               var text = document.getElementById("displayOwner"+ss);
               var as= $(this).attr("value").replace("Owner_show","");
               $("#tesOwnerPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Coor Collapsable       
       $(".Coor_show").click(function(){
               var ss =  $(this).attr("id").replace("Coor_show","");
               var ele = document.getElementById("tesCoorPosted"+ss);
               var text = document.getElementById("displayCoor"+ss);
               var as= $(this).attr("value").replace("Coor_show","");
               $("#tesCoorPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });

       //Appr Collapsable       
       $(".Appr_show").click(function(){
               var ss =  $(this).attr("id").replace("Appr_show","");
               var ele = document.getElementById("tesApprPosted"+ss);
               var text = document.getElementById("displayAppr"+ss);
               var as= $(this).attr("value").replace("Appr_show","");
               $("#tesApprPosted"+ss).toggle("slow");
               if(ele.style.display === "block") {
                       ele.style.display = "none";
                       text.innerHTML = "Show History";
               }else {
                       ele.style.display = "block";
                       text.innerHTML = "Hide History";
               }
       });
                        
});
</script> 

<style type="text/css">
div#issueFilterBox {
	padding-top: 5px;
	float: left;
	width: 70%;
}
div#issueSearchBox {
	padding-top: 5px;
//	float: right;
//	width: 25%;
	text-align: right;
}
div.issueClear {
	float: none;
	clear: both;
}
.s_clo, .s_res {
	text-decoration: line-through;
}
.spAssigned{
	font-weight:900;
        color:#BBBBBB;
}
.spDone{
	font-weight:900;
        color:#335fff;
}
.spCancel{
	font-weight:900;
        color:#fb3232;
}
.spGoing{
	font-weight:900;
        color:#999999;
}
.spWaiting{
	font-weight:900;
        color:#666666;
}
.spExecuted{
        font-weight:900;
        color:#AEB404;
}
.commentMark{
	color:grey;
}

//
a {
	font-size:20%;
        color: #0254EB;
}
a:visited {
        color: #0254EB;
}
a.morelink {
        text-decoration:none;
        outline: none;
}
.morecontent span {
        display: none;

}
</style>               

<?php
$monthLong = array (
        1 => 'January',
        2 => 'February',
        3 => 'March',
        4 => 'April',
        5 => 'May',
        6 => 'June',
        7 => 'July',
        8 => 'August',
        9 => 'September',
        10 => 'October',
        11 => 'November',
        12 => 'December'
    );

 $startyear=date("Y");
 if($this->filterMnt==""){
      $selMonth=substr(date("F",time() - date("j")*24*60*60),0,3);
 }
 else{
      $selMonth=$this->filterMnt;
 }

 if($this->filterYr=="") {
     if($selMonth=="Dec"){
        $selYear=date("Y")-1;
     }
     else{
        $selYear=date("Y");
     }
 }
 else{
     $selYear=$this->filterYr;
 }
 $startyear=date("Y");
 $endyear=date("Y")-10;
?>

<?php if (isset($this->search) && $this->search === true): ?>
<div id="issueSearchBox">
        <form name="bt_search" method="get" action="<?php echo $this->formAction; ?>">
          <input type="hidden" name="title" value="<?php echo $this->pageKey; ?>" />
          <input type="hidden" name="project" value="<?php echo $this->project; ?>" />
          <input type="hidden" name="bt_action" value="<?php echo $this->action; ?>" />   
            <?php            
            if (isset($_REQUEST['bt_filter_status']) && $_REQUEST['bt_filter_status']=="archived") {
              $check = "checked";
              $labelSearch = wfMessage('search')." in Archived"; 
            } else {
              $check = "";
              $labelSearch = wfMessage('search');              
            }
            ?>
          <label for="bt_search_string"><?php echo $labelSearch; ?> </label>
          <input type="text" name="bt_search_string" id="bt_search_string" value="<?php echo (isset($this->searchString)) ? $this->searchString : ''; ?>" />               
          <input hidden type="checkbox" name="bt_filter_status" value="archived" <?php echo $check;?>/>
          <input type="submit" name="bt_search" id="bt_search" value="<?php echo wfMessage('form_submit'); ?>" />
        </form>
</div>
<?php endif; ?>                     
               
<?php if (isset($_GET["msg_update"])): ?>
<p class="success"><?php echo $_GET["msg_update"]; ?></p>
<?php endif; ?>

<?php if ( isset($this->filter) && $this->filter === true ) : ?>
<div id="issueFilterBox">
	<form name="bt_filter" method="get" action="<?php echo $this->formAction; ?>">
        <input type="hidden" name="title" value="<?php echo $this->pageKey; ?>" />
        <input type="hidden" name="project" value="<?php echo $this->project; ?>" />
        <input type="hidden" name="bt_action" value="<?php echo $this->action; ?>" />
         <?php if ($this->isIbugLoggedIn()): ?>
        <select name="bt_filter_by" style="display:none">
        <optgroup label="filter" title="Filter">
          <option value="all"<?php echo ($this->filterBy == null) ? ' selected="true"' : ''; ?>>All issues</option>
          <option value="reported_by_me"<?php echo ($this->filterBy == 'reported_by_me') ? ' selected="true"' : ''; ?>>Reported by me</option>
          <option value="assined_to_me"<?php echo ($this->filterBy == 'assined_to_me') ? ' selected="true"' : ''; ?>>Assigned to me</option>
        </select>
        <?php endif; ?>
          
        <table border="0" cellpadding="2" cellspacing="2">
            <tr>
                <td valign="top" align="left">
                        <br />
                        <label for="bt_filters"><?php echo wfMessage('filter_title'); ?>: </label>
                </td>
                <td valign="top" align="middle">
                    <strong>Themes</strong> <br />
                    <select name="bt_filter_type">
                        <optgroup label="themes" title="Themes">
                            <option value="any"<?php echo ($this->filterType == null) ? ' selected="true"' : ''; ?>>Any</option>
                                <?php                        
                                foreach ($this->ArrThemes as $tag=>$val) { ?> 
                                    <option value="<?php echo $tag;?>"<?php echo ($this->filterType == $tag) ? ' selected="true"' : ''; ?>><?php echo $val[theme]; ?></option>
                                <?php } ?>
                        </optgroup>
                     </select>
                    <div align="left">&nbsp;<a href="<?php echo $this->resetUrl; ?>">reset filter</a></div>
                </td>  
                <td valign="top" align="middle" width="100px">
                    <strong>Status</strong> <br />
                    <select name="bt_filter_status">
                    <optgroup label="status" title="Status">
                        <option value="any"<?php echo ($this->filterStatus == null) ? '' : ''; ?>>Any</option>                    
                        <optgroup label="&nbsp;&nbsp;&nbsp;&nbsp;task status consist of" title="bugStatus">
                        <?php foreach ($this->issueStatus as $name => $status): 
                            if ($status['Gstatus']=='bug1') { ?>
                             <option value="<?php echo $name; ?>"<?php echo ($this->filterStatus == $name || ($this->filterStatus == null && $status['name']=='Bug Working') ) ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;<?php echo str_replace('Bug','iTask',$status['name']); ?></option>
                        <?php } endforeach; ?>
                        <option value="s_w1" <?php echo ($this->filterStatus == 's_w1') ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;Task Waiting</option>
                            <optgroup label="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;task waiting status consist of" title="bugWaiting">     
                                <?php foreach ($this->issueStatus as $name => $status): 
                                    if ($status['Gstatus']=='bugw'){ ?>
                                    <option value="<?php echo $name; ?>"<?php echo ($this->filterStatus == $name) ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo str_replace('Bug','iTask',$status['name']); ?></option>
                                    <?php } endforeach; ?>
                            </optgroup>
                         <?php $secondST="F"; foreach ($this->issueStatus as $name => $status): 
                            if ($status['Gstatus']=='bug2') { ?>
                            <option value="<?php echo $name; ?>"<?php echo ($this->filterStatus == $name) ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo str_replace('Bug','iTask',$status['name']); ?></option>
                            <?php 
                            }
                                if ($status['Gstatus']=='ori1') { 
                                $secondST="T";$secondST1="original"; $secondW="Waiting"; $secondST2="original waiting";}
                                if ($status['Gstatus']=='new1') { 
                                $secondST="T";$secondST1="new improvement"; $secondW="New Development Waiting"; $secondST2="new improvement waiting";}
                            endforeach; ?>                                                                   
                        </optgroup>
                            <?php if ($secondST=='T') { ?>
                                <optgroup label="&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $secondST1.$secondST; ?> status consist of" title="bugStatus">
                                <?php foreach ($this->issueStatus as $name => $status):
                                    if ($status['Gstatus']=='ori1' || $status['Gstatus']=='new1') { ?>                        
                                    <option value="<?php echo $name; ?>"<?php echo ($this->filterStatus == $name) ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;<?php echo $status['name']; ?></option>
                                <?php } endforeach; ?>
                                    <option value="s_w2" <?php echo ($this->filterStatus == 's_w2') ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;<?php echo $secondW; ?></option>
                                    <optgroup label="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $secondST2; ?> status consist of" title="bugWaiting">     
                                        <?php foreach ($this->issueStatus as $name => $status): 
                                            if ($status['Gstatus']=='oriw' || $status['Gstatus']=='neww' ){ ?>
                                            <option value="<?php echo $name; ?>"<?php echo ($this->filterStatus == $name) ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $status['name']; ?></option>
                                            <?php } endforeach; ?>
                                    </optgroup>
                                    <?php foreach ($this->issueStatus as $name => $status): 
                                    if ($status['Gstatus']=='ori2' || $status['Gstatus']=='new2') { ?>
                                    <option value="<?php echo $name; ?>"<?php echo ($this->filterStatus == $name) ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<?php echo $status['name']; ?></option>
                                    <?php } endforeach; ?>
                                </optgroup>
                            <?php } ?>
                        <option value="archived"<?php echo ($this->filterStatus == 'archived') ? ' selected="true"' : ''; ?>>&nbsp;&nbsp;&nbsp;&nbsp;Archived</option>
                    </optgroup>
                    </select>
                    <?php
                    if($this->filterStatus=="archived"){ ?>
                            <div style="display:inline;">
                    <?php
                    }
                    else{?>
                            <div style="display:none;">
                    <?php
                    }
                    ?>
                    <label>Month Year : </label>
                    <select name="bt_filter_mnth">
                    <option value="any"<?php echo ($this->filterMnt == null) ? ' selected="true"' : ''; ?>>Any</option>     
                    <?php for ($i=1;$i<=12;$i++){ ?>
                    <option value="<?php echo substr($monthLong[$i],0,3); ?>"<?php echo ($selMonth == substr($monthLong[$i],0,3)) ? ' selected="true"' : ''; ?>><?php echo $monthLong[$i]; ?></option>
                    <?php } ?>
                    </select>

                    <select name="bt_filter_yr">
                    <!--<option value="any"<?php echo ($this->filterYr == null) ? ' selected="true"' : ''; ?>>Any</option>-->         
                     <?php
                     $i=$startyear;
                     while($i>=$endyear){?>
                     <option value="<?php echo $i; ?>"<?php echo ($selYear == $i) ? ' selected="true"' : ''; ?>><?php echo $i; ?></option>
                     <?php
                            $i--;
                     } ?>
                    </select>
                    </div>
                </td>

                <td valign="top" align="middle">
                   <strong>Owner</strong><br />
                   <select name="bt_filter_owned_by">
                   <optgroup label="owner" title="Owner">                         
                        <?php  foreach ($this->issueOwned_by as $name => $owned_by): ?>
                        <option value="<?php echo $name; ?>"<?php echo ($this->filterOwned_by == $name) ? ' selected="true"' : ''; ?>><?php echo $owned_by['name']; ?></option>
                        <?php endforeach; ?>
                   </optgroup>
                   </select>
                </td>         
                <td valign="top" align="middle">
                        <strong>Coordinator</strong><br />
                        <select name="bt_filter_coor">
                        <optgroup label="coor" title="Coordinator">
                        <option value="any"<?php echo ($this->filterCoor == null) ? ' selected="true"' : ''; ?>>Any</option>
                        <?php foreach ($this->issueCoor_by as $name => $coor_by): ?>
                        <option value="<?php echo $name; ?>"<?php echo ($this->filterCoor == $name) ? ' selected="true"' : ''; ?>><?php echo $coor_by['name']; ?></option>
                        <?php endforeach; ?>
                        </optgroup>
                        </select>

                </td>
                <td valign="top" align="middle">
                        <strong>Requester</strong><br />

                        <select name="bt_filter_approv_by">
                        <optgroup label="requester" title="Requester">
                        <option value="any"<?php echo ($this->filterApprov_by == null) ? ' selected="true"' : ''; ?>>Any</option>
                        <?php foreach ($this->issueApprov_by as $name => $approv_by): ?>
                        <option value="<?php echo $name; ?>"<?php echo ($this->filterApprov_by == $name) ? ' selected="true"' : ''; ?>><?php echo $approv_by['name']; ?></option>
                        <?php endforeach; ?>
                        </optgroup>
                                <optgroup label="external users" title="external users">
                                <?php foreach ($this->issueApprov_by_AL as $name => $approv_by){ ?>
                                <option value="<?php echo $name; ?>"<?php echo ($this->getUsrName == $approv_by['name']) ? ' selected="true"' : ''; ?>><?php echo $approv_by['name']; ?></option>
                                <?php  } ?>
                                </optgroup> 
                        </select>

                </td>
                <td valign="top" align="middle">
                        <strong>Priority</strong><br />
                        <select name="bt_filter_priority">
                        <optgroup label="priority" title="Priority">
                        <option value="any"<?php echo ($this->filterPriority == null) ? ' selected="true"' : ''; ?>>Any</option>
                        <?php foreach ($this->issuePriority as $name => $priority): ?>
                        <option value="<?php echo $name; ?>"<?php echo ($this->filterPriority == $name) ? ' selected="true"' : ''; ?>><?php echo $priority['name']; ?></option>
                        <?php endforeach; ?>
                        </optgroup>
                        </select>

                </td>
                <td valign="top" align="middle">
                       <br />
                       <input type="submit" name="bt_filter" id="bt_filter"  value="<?php echo wfMessage('form_apply'); ?>" />
                </td>
            </tr>
         </table>

	</form>
</div>
<?php endif; ?>
      

<div class="issueClear"></div>
<h2><?php if ($this->auth === false || ($this->auth === true && $this->isIbugLoggedIn === true)): ?>
<span class="editsection">[<a href="<?php echo $this->addUrl; ?>"><?php echo wfMessage('add'); ?></a>]</span> 
<?php else: ?>
<span class="editsection"><?php echo wfMessage('login_msg'); ?></span>
<?php endif; ?>
<span class="mw-headline"><?php echo wfMessage('view_issues'); ?></span></h2>
<script type="text/javascript">
function selectToggle(toggle, form) {
     var myForm = document.forms[form];
     for( var i=0; i < myForm.length; i++ ) {
          if(toggle) {
               myForm.elements[i].checked = "checked";
          }
          else {
               myForm.elements[i].checked = "";
          }
     }
}

</script>

<form name="frmIbug" id="frmIbug" method="POST" action="<?php echo $this->formAction; ?>">
<table cellpadding="2" width="100%" style="font-size: 90%;table-layout:fixed;word-wrap:break-word;White-space:Normal;" id="ibugTable">
<thead> 
  <tr  style="background-color: #dddddd;">
  	<?php
		$cleanURL=removeUrlvalue('sortKey',curPageURL());
		$cleanURL=removeUrlvalue('sortType',$cleanURL);
	?>

    <th valign="bottom" align="center" style="width:3%;"><b><?php echo wfMessage('issue_num'); ?></b>
	<?php		
                $ScriptPath= $this->ScriptPath;	
		$imgsrc=$ScriptPath.'/img/bg.gif';
		$sorturl=$this->curUrl.'&sortKey=issue_num&sortType=ac';
		if ($this->sortKey=='issue_num' && $this->sortType=='ac'){
			$imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=issue_num&sortType=dc';
		}
		elseif ($this->sortKey=='issue_num' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			 $sorturl=$this->curUrl.'&sortKey=issue_num&sortType=ac';
                }
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>" /></a></th>
    <th valign="bottom" align="center" style="width:15%;"><b><?php echo wfMessage('title'); ?></b>
     		
	<?php		
		$imgsrc=$ScriptPath.'/img/bg.gif';
		$sorturl=$this->curUrl.'&sortKey=title&sortType=ac';
	        if ($this->sortKey=='title' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
                	$sorturl=$this->curUrl.'&sortKey=title&sortType=dc';
		}
                elseif ($this->sortKey=='title' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=title&sortType=ac';
                }
		
	?>
	<br /><a href=" <?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>

    <th valign="bottom" align="center" style="width:5%;"><b><?php echo wfMessage('themes'); ?></b>

        <?php

                $imgsrc=$ScriptPath.'/img/bg.gif';
                $sorturl=$this->curUrl.'&sortKey=title&sortType=ac';
                if ($this->sortKey=='section' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
                        $sorturl=$this->curUrl.'&sortKey=title&sortType=dc';
                }
                elseif ($this->sortKey=='section' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
                        $sorturl=$this->curUrl.'&sortKey=title&sortType=ac';
                }

        ?>
        <br /><a href=" <?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>

    <th valign="bottom" align="center" width="6%"><b><?php echo wfMessage('start_date_j'); ?></b>
     		
	<?php	
		$sorturl=$this->curUrl.'&sortKey=start_date&sortType=ac';
		$imgsrc=$ScriptPath.'/img/bg.gif';                
		if ($this->sortKey=='start_date' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=start_date&sortType=dc';
                }
                elseif ($this->sortKey=='start_date' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=start_date&sortType=ac';
                }
		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
     <th valign="bottom" align="center" width="6%"><b><?php echo wfMessage('target_date_j'); ?></b>
     		
	<?php	
		$sorturl=$this->curUrl.'&sortKey=target_date&sortType=ac';
		$imgsrc=$ScriptPath.'/img/bg.gif';                
		if ($this->sortKey=='target_date' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=target_date&sortType=dc';
                }
                elseif ($this->sortKey=='target_date' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=target_date&sortType=ac';
                }
		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
    <th valign="bottom" align="center" width="6%"><b><?php echo wfMessage('due_date_i'); ?></b>
		
	<?php	
		$imgsrc=$ScriptPath.'/img/bg.gif';
		$sorturl=$this->curUrl.'&sortKey=due_date&sortType=ac';
                if ($this->sortKey=='due_date' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=due_date&sortType=dc';
                }
                elseif ($this->sortKey=='due_date' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=due_date&sortType=ac';
                } 
		    
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
        <th valign="bottom" align="center" width="7%"><b><?php echo wfMessage('targ_accom_i')->text(); ?></b>
       
	<?php	
		
		$sorturl=$this->curUrl.'&sortKey=targ_accom&sortType=ac';
		$imgsrc=$ScriptPath.'/img/bg.gif';
                if ($this->sortKey=='targ_accom' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=targ_accom&sortType=dc';
                }
                elseif ($this->sortKey=='targ_accom' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=targ_accom&sortType=ac';
                }
		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
    <th valign="bottom" align="center" width="4%"><b><?php echo wfMessage('priority'); ?></b>
     
	<?php	
		
		$imgsrc=$ScriptPath.'/img/bg.gif';
		$sorturl=$this->curUrl.'&sortKey=priority&sortType=ac';
                if ($this->sortKey=='priority' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=priority&sortType=dc';
                }
                elseif ($this->sortKey=='priority' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=priority&sortType=ac';
                }

		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
    <th valign="bottom" align="center" width="7%"><b><?php echo wfMessage('status'); ?></b>
     
	<?php	
		
		$imgsrc=$ScriptPath.'/img/bg.gif';
		$sorturl=$this->curUrl.'&sortKey=status&sortType=ac';
                if ($this->sortKey=='status' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=status&sortType=dc';
                }
                elseif ($this->sortKey=='status' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=status&sortType=ac';
                }
		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
    <th valign="bottom" align="center" width="4%"><b><?php echo wfMessage('owner'); ?></b>
     
	<?php	
		
		$imgsrc=$ScriptPath.'/img/bg.gif';
		$sorturl=$this->curUrl.'&sortKey=owner&sortType=ac';
                if ($this->sortKey=='owner' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=owner&sortType=dc';
                }
                elseif ($this->sortKey=='owner' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=owner&sortType=ac';
                }
		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
	<th valign="bottom" align="center" width="6%"><b><?php echo wfMessage('coor'); ?></b>

        <?php

                $imgsrc=$ScriptPath.'/img/bg.gif';
                $sorturl=$this->curUrl.'&sortKey=coorsortType=ac';
                if ($this->sortKey=='coor' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
                        $sorturl=$this->curUrl.'&sortKey=coor&sortType=dc';
                }
                elseif ($this->sortKey=='coor' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
                        $sorturl=$this->curUrl.'&sortKey=coor&sortType=ac';
                }

        ?>
        <br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
    <th valign="bottom" align="center" width="5%"><b>Requester</b>
		
	<?php	
		
		$imgsrc=$ScriptPath.'/img/bg.gif';
		$sorturl=$this->curUrl.'&sortKey=approv_by&sortType=ac';
                if ($this->sortKey=='approv_by' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=approv_by&sortType=dc';
                }
                elseif ($this->sortKey=='approv_by' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=approv_by&sortType=ac';
                } 
		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
    <th valign="bottom" align="center" width="32%"><b><?php echo ('Comments'); ?></b>
	
	<?php	
		
		$sorturl=$this->curUrl.'&sortKey=summary&sortType=ac';
		$imgsrc=$ScriptPath.'/img/bg.gif';
                if ($this->sortKey=='summary' && $this->sortType=='ac'){
                        $imgsrc=$ScriptPath.'/img/desc.gif';
			$sorturl=$this->curUrl.'&sortKey=summary&sortType=dc';
                }
                elseif ($this->sortKey=='summary' && $this->sortType=='dc'){
                        $imgsrc=$ScriptPath.'/img/asc.gif';
			$sorturl=$this->curUrl.'&sortKey=summary&sortType=ac';
                } 
		
	?>
	<br /><a href="<?php echo $sorturl; ?>"><img border=0 src="<?php echo $imgsrc; ?>"" /></a></th>
    <th valign="bottom" align="center" width="7%"><b><?php echo wfMessage('action'); ?></b><br />&nbsp;</th>
  </tr>
</thead> 
<tbody>
<?php
	$prevcode="";
	$lenprevcode=0;
        $Lnum=1;
	$Lcode="";
	$prevsection="";
	$idx=0;	
	$sumDelay=0;
        $sumMistake=0; 
	$sumSatisfaction=0;
	$boolcoda=false;
 
$srtIssues=null;
$id=0;
while ($issue = $this->issues->fetchObject()): 
if  ($this->arribugnumbering[$issue->issue_id] != ""){
$strIssues[$id]= array('num' =>  $this->arribugnumbering[$issue->issue_id], 
			'issue_id' => $issue->issue_id,
			'title' => $issue->title ,
			'start_date' => $issue->start_date , 
                        'depend_id' => $issue->depend_id ,
                        'target_date' => $issue->target_date , 
			'due_date' => $issue->due_date ,
			'priority' => $issue->priority ,
			'priority_name' => $this->issuePriority[$issue->priority]['name'] ,
			'type' => $issue->type , 
                        'type1' => $issue->type1 , 
			'type_name' => $this->issueType[$issue->type]['name'] ,
                        'type_name1' => $this->issueType[$issue->type1]['name'] ,
			'type_color' => $this->issueType[$issue->type]['colour'] ,
			#'perc_complete' => substr($issue->perc_complete,0,-1) , 
			'targ_accom' => $issue->targ_accom, ENT_QUOTES , 
			'status_id' => $issue->status ,
 			'status' => $this->issueStatus[$issue->status]['name'] , 
			'status_color' => $this->issueStatus[$issue->status]['colour'] ,
			'owned_by' => ($this->issueOwned_by[$issue->owned_by]['name'])? $this->issueOwned_by[$issue->owned_by]['name']:$issue->owned_by ,                         
			#'approv_by' => $this->issueApprov_by[$issue->approv_by]['name'] ,
                        'approv_by' => $issue->approv_by ,
			'coor' => $this->issueCoor_by[$issue->coor]['name'],
			'rndfile' => $issue->Issuerndfile , 
			'summary' => $issue->summary,
			'creator' => $issue->creator,
			'user_name' => $issue->user_name,
			'reason' => $issue->reason,
			'number' => $issue->number,
                        'parent_id' => $issue->parent_id,
                        'parent_project' => $issue->parent_project,
                        'parent_project1' => $issue->parent_project1,
                        'last_modifier' => $issue->last_modifier );
$id++;
}
$ArrIssue[] = $issue->issue_id;
endwhile; 
//var_dump($strIssues);
          
//Put Each Group Concat Result to Array//
$this->TitleLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'title');
$this->ThemesLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'type');
$this->ThemesLogs2 = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'type1');
$this->StartLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'start_date');
$this->TargetLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'target_date');
$this->nextStepLogs = $this->getIbugModel('default')->getNextArrayList($ArrIssue,'nextStep');
$this->PriorityLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'prior');
$this->StatusLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'status');
$this->OwnerLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'owner');
$this->CoorLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'coor');
$this->ApprLogs = $this->getIbugModel('default')->getStatusArrayList($ArrIssue,'approv');
$this->IssueComments = $this->getIbugModel('default')->getCommentArrayList($ArrIssue);
//var_dump($this->PriorityLogs );  

$idx=-1;
if ($id>0){
if ($this->sortKey=='issue_num' && $this->sortType=='ac'){
	usort($strIssues, "cmpString_Issue_num_ac");
}
elseif ($this->sortKey=='issue_num' && $this->sortType=='dc'){
	usort($strIssues, "cmpString_Issue_num_dc");
}
elseif ($this->sortKey=='title' && $this->sortType=='ac'){
        usort($strIssues, "cmpString_Issue_title_ac");
}
elseif ($this->sortKey=='title' && $this->sortType=='dc'){
        usort($strIssues, "cmpString_Issue_title_dc");
}
elseif ($this->sortKey=='start_date' && $this->sortType=='ac'){
        usort($strIssues, "cmpDate_Issue_start_date_ac");
}
elseif ($this->sortKey=='start_date' && $this->sortType=='dc'){
        usort($strIssues, "cmpDate_Issue_start_date_dc");
}
elseif ($this->sortKey=='target_date' && $this->sortType=='ac'){
        usort($strIssues, "cmpDate_Issue_target_date_ac");
}
elseif ($this->sortKey=='target_date' && $this->sortType=='dc'){
        usort($strIssues, "cmpDate_Issue_target_date_dc");
}
elseif ($this->sortKey=='due_date' && $this->sortType=='ac'){
        usort($strIssues, "cmpDate_Issue_due_date_ac");
}
elseif ($this->sortKey=='due_date' && $this->sortType=='dc'){
        usort($strIssues, "cmpDate_Issue_due_date_dc");
}
elseif ($this->sortKey=='perc_complete' && $this->sortType=='ac'){
        usort($strIssues, "cmpInt_Issue_perc_complete_ac");
}
elseif ($this->sortKey=='perc_complete' && $this->sortType=='dc'){
        usort($strIssues, "cmpInt_Issue_perc_complete_dc");
}
elseif ($this->sortKey=='targ_accom' && $this->sortType=='ac'){
        usort($strIssues, "cmpDate_Issue_targ_accom_ac");
}
elseif ($this->sortKey=='targ_accom' && $this->sortType=='dc'){
        usort($strIssues, "cmpDate_Issue_targ_accom_dc");
}
elseif ($this->sortKey=='priority' && $this->sortType=='ac'){
        usort($strIssues, "cmpInt_Issue_priority_ac");
}
elseif ($this->sortKey=='priority' && $this->sortType=='dc'){
        usort($strIssues, "cmpInt_Issue_priority_dc");
}
elseif ($this->sortKey=='status' && $this->sortType=='ac'){
        usort($strIssues, "cmpString_Issue_status_id_ac");
}
elseif ($this->sortKey=='status' && $this->sortType=='dc'){
        usort($strIssues, "cmpString_Issue_status_id_dc");
}
elseif ($this->sortKey=='owner' && $this->sortType=='ac'){
        usort($strIssues, "cmpString_Issue_owned_by_ac");
}
elseif ($this->sortKey=='owner' && $this->sortType=='dc'){
        usort($strIssues, "cmpString_Issue_owned_by_dc");
}
elseif ($this->sortKey=='approv_by' && $this->sortType=='ac'){
        usort($strIssues, "cmpString_Issue_approv_by_ac");
}
elseif ($this->sortKey=='approv_by' && $this->sortType=='dc'){
        usort($strIssues, "cmpString_Issue_approv_by_dc");
}
elseif ($this->sortKey=='summary' && $this->sortType=='ac'){
        usort($strIssues, "cmpString_Issue_summary_ac");
}
elseif ($this->sortKey=='summary' && $this->sortType=='dc'){
        usort($strIssues, "cmpString_Issue_summary_dc");
}
}

if ($id > 0){
while ($idx <= $id):
if ($strIssues[$idx]['num']!= ""){
?>
    <?php 
	//for status
	$curcode=substr($strIssues[$idx]['status_id'],-1);	
	$lencurcode=strlen($strIssues[$idx]['status_id']);
        if ($curcode!==$prevcode || $lencurcode!==$lenprevcode){
             $prevcode=$curcode;
             $lenprevcode=strlen($strIssues[$idx]['status_id']);
	     
            	if ($prevcode=="a" && $lenprevcode==5){
			echo "<tr>";
                	echo '<td colspan="15" valign="middle" style="text-align:center;" height="13px">';
                	$Lnum=1;
				echo "<span class='spAssigned'>Assigned</span>";
				$Lcode="N";
				$prevsection="";
				$boolcoda=false;
			echo '<br /><hr size="1" width="100%" />';
                	echo "</td>";
             		echo "</tr>";
		}
		elseif($prevcode=="b" && $lenprevcode==5 ){
			echo "<tr>";
                	echo '<td colspan="15" valign="middle" style="text-align:center;" height="13px">';
                	$Lnum=1;
				echo "<span class='spGoing'>In development</span>";
				$Lcode="C";
				$prevsection="";
				$boolcoda=false;
			echo '<br /><hr size="1" width="100%" />';
                	echo "</td>";
             		echo "</tr>";
		}
		elseif($lenprevcode==6 && $boolcoda==false){
                        echo "<tr>";
                	echo '<td colspan="15" valign="middle" style="text-align:center;" height="13px">';
                	$Lnum=1;	
				echo "<span class='spWaiting'>Waiting</span>";
				$boolcoda=true;
				$Lcode="W";
				$prevsection="";
			echo '<br /><hr size="1" width="100%" />';
                	echo "</td>";
             		echo "</tr>";
		}
                elseif($prevcode=="d" && $lenprevcode==5){
                        echo "<tr>";
                	echo '<td colspan="15" valign="middle" style="text-align:center;" height="13px">';
                	$Lnum=1;
				echo "<span class='spDone'>Approved</span>";
				$Lcode="D";
				$prevsection="";
				$boolcoda=false;
			echo '<br /><hr size="1" width="100%" />';
                	echo "</td>";
             		echo "</tr>";
		}
                elseif($prevcode=="e" && $lenprevcode==5){
                        echo "<tr>";
                	echo '<td colspan="15" valign="middle" style="text-align:center;" height="13px">';
                	$Lnum=1;
				echo "<span class='spCancel'>Cancelled</span>";
				$Lcode="E";
				$prevsection="";
				$boolcoda=false;
			echo '<br /><hr size="1" width="100%" />';
               		echo "</td>";
             		echo "</tr>";		
		}		   
	}
	else{
		$Lnum++;
	}		
     ?>
	
	<?php 	
	if ($strIssues[$idx]['type'] != $prevsection){		
		$prevsection=$strIssues[$idx]['type'];
		echo '<tr>';
                echo '<td colspan="15" valign="middle" align="left" height="2px"></td>';
                echo '</tr>';
		echo '<tr>';
		echo '<td height="20px">&nbsp;</td>';			
                $tag_name=$strIssues[$idx]['type'];                               
		echo '<td colspan="3" valign="middle" align="left" style="background-color: '.$this->ArrThemes[$tag_name][colour].'">&nbsp;&nbsp;&nbsp;';
                echo '<strong>'.$this->ArrThemes[$tag_name][theme].'</strong>';		
                echo '<td colspan="3" valign="middle" align="left" style="background-color: #'. $strIssues[$idx]['type_color'].'">&nbsp;&nbsp;&nbsp;';
                echo '<strong>'.$strIssues[$idx]['type_name'].'</strong>';
		echo '</td>';
		echo '<td colspan="10" valign="middle" align="left">&nbsp;</td>';		
		echo '</tr>';	
	}
	if ($idx%2==1){
		
		$strstyle='style="background-color: #F3F3F3;"';
		$editstatusclass="topmenu_grey";
	}
	else{
		$strstyle='';
         	$editstatusclass="topmenu";
	}	

	if($strIssues[$idx]['priority_name']=="URGENT"){
		 $strstyle='style="background-color: #fdff49;"';
		 $editstatusclass="topmenu_yellow";
	}

	if ($strIssues[$idx]['owned_by']=="Manas"){
		$strstyleManas='style="color:#00f;"';
	}
	else{
		$strstyleManas='';
	}


	?>  

  <tr <?php echo $strstyle; ?>   >
    <?php $crt=$strIssues[$idx]['user_name'];
          $mdfr=$strIssues[$idx]['last_modifier'];
    ?>
    
    <td valign="top" style="text-align:center;"  ><?php if ($this->hasIbugViewPerms): ?><a href="<?php echo $this->viewUrl . $strIssues[$idx]['issue_id']; ?>"><?php echo $strIssues[$idx]['num']; ?></a><?php else: ?> <?php echo $strIssues[$idx]['num']; endif; ?>
    <br />
    <?php  
    $par_id=$strIssues[$idx]['parent_project'];     
    //var_dump($par_id);           
    $arr_value = explode("-",$par_id);      
    $arr_value_ = explode("-",$par_id,2);
    if ($par_id) {             
        if ($arr_value_[1]=="RunJobs") {
        $_parent = "None";              
        $_page_id = "";
        }else{     
        //$_parent =  $arr_value[0]." : ".$arr_value_[1];             
        $_parent =  ($ArrProj[$arr_value[0]])? $ArrProj[$arr_value[0]] : $arr_value[0]." : ".$arr_value_[1];
        $_page_id =  $arr_value_[1];
        }
    }else{
    $_parent = "None";      
    $_page_id = "";
    }      
        $par_id2=$strIssues[$idx]['parent_project1'];                
        $arr_value2 = explode("-",$par_id2);      
        $arr_value_2 = explode("-",$par_id2,2);
        if ($par_id2) {             
                if ($arr_value_2[1]=="RunJobs") {
                $_parent2 = "None";              
                }else{     
                //$_parent2 =  $arr_value2[0]." : ".$arr_value_2[1];     
                $_parent2 =($ArrProj[$arr_value2[0]])? $ArrProj[$arr_value2[0]] : $arr_value2[0]." : ".$arr_value_2[1];            
                $_page_id2 =  $arr_value_2[1];
                }
        }else{
        $_parent2 = "None";      
        }
    ?>      
<!--<div class="editparent" id="div_par<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo $_parent;?></div><div class="rsltparent1" id="div_par1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltparent">-->      
    <input type="checkbox" name="chkIssue[]" value="<?php echo $strIssues[$idx]['issue_id']; ?>">        
    </td>
    
    <td valign="top"  style="text-align:left;"  > 
    <?php 
    $arNewvalue = explode("~^~",$this->TitleLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
    $arUsers = explode("~^~",$this->TitleLogs[$strIssues[$idx]['issue_id']]["users"]);              
    $arTimestamp = explode("~^~",$this->TitleLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
    $TitleCount = $this->TitleLogs[$strIssues[$idx]['issue_id']]["totS"];    
    if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
    <div class="edittitle" id="div_ttl<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo htmlspecialchars($strIssues[$idx]['title'], ENT_QUOTES);  ?></div><div class="rslttitle1" id="div_tle1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rslttitle">
    <?php } else { ?><?php echo htmlspecialchars($strIssues[$idx]['title'], ENT_QUOTES);  ?><div class="rslttitle1" id="div_tle1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rslttitle">
    <?php } 
    if (!empty($TitleCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }                                    
    ?>
    </div>
        <div class="rslttitle1" id="div_tle1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'TitlePosted'.$strIssues[$idx]['issue_id']; ?>" class="TitlePosted">
            <?php	
                 if($TitleCount>1){                                   
                 ?>
                 <div id="<?php echo 'Title_show'.$strIssues[$idx]['issue_id']; ?>" class="Title_show" style="text-align:left;" value="<?php echo $TitleCount;?>"><a id="<?php echo 'displayTitle'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesTitlePosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($TitleCount); $x++) {                   
                         ?>                    
                         <div align="left" style="text-align:left; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             
        </div>	 
        <div class="commentBox" align="right" id="restrictionBox-<?php echo $strIssues[$idx]['issue_id']; ?>" >
        <div id="<?php echo 'textshow'.$strIssues[$idx]['issue_id']; ?>" class="textshow" style="text-align:center;background-color:#92D4E3;" ><a id="<?php echo 'displayRestriction'.$strIssues[$idx]['issue_id']; ?>"  href="<?php echo 'javascript:show_access_list(' .$strIssues[$idx]['issue_id'] . ')'; ?>" style="font-size:13px">Show Restriction</a></div>        
            <div id="<?php echo 'textRestriction'.$strIssues[$idx]['issue_id']; ?>">               
            </div>    
        </div>      
    <br/>      
    <!--<span class="TitlePosted"><strong>1st Parent Project :</strong></span>-->      
    <div class="editparent" id="div_par<?php echo $strIssues[$idx]['issue_id']; ?>" title="Click to Edit Parent Project"><?php echo $_parent;?></div><div class="rsltparent1" id="div_par1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltparent">                
    <?php
       //$page_title = explode(" : ",$_parent);   
       $page_url = "https://".$wgServerName.$this->ArticlePath."/".$_page_id;
       //$_label = ($_parent=="None")? "":"1st Project Page : ";    
    ?>      
    <?php echo $_label;?><a id="div_par_page<?php echo $strIssues[$idx]['issue_id']; ?>" href="<?php echo $page_url; ?>" target="_blank"><?php echo $_page_id;?></a>      
    <br/>
    <hr/> <!--2nd theme-->
    <!--<span class="TitlePosted"><strong>2nd Parent Project :</strong></span>-->      
    <div class="editparent_2" id="div_par2<?php echo $strIssues[$idx]['issue_id']; ?>" title="Click to Edit Parent Project"><?php echo $_parent2;?></div><div class="rsltparent1" id="div_par1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltparent">                
    <?php
       //$page_title = explode(" : ",$_parent2);   
       $page_url = "https://".$wgServerName.$this->ArticlePath."/".$_page_id2;
       //$_label = ($_parent2=="None")? "":"2nd Project Page : ";    
    ?>      
    <?php echo $_label;?><a id="div_par_page2<?php echo $strIssues[$idx]['issue_id']; ?>" href="<?php echo $page_url; ?>" target="_blank"><?php echo $_page_id2;?></a>      
    </td>
	
    <?php   
    if ($strIssues[$idx]['type_name']==null || $strIssues[$idx]['type_name']==''){
    $tag_name = $strIssues[$idx]['type'];   
    $tag_name2 = ($strIssues[$idx]['type1'])? $strIssues[$idx]['type1']:'';    
    ?>
    <td valign="top"  style="text-align:center;">
    <?php
    $arNewvalue = explode("~^~",$this->ThemesLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
    $arUsers = explode("~^~",$this->ThemesLogs[$strIssues[$idx]['issue_id']]["users"]);              
    $arTimestamp = explode("~^~",$this->ThemesLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
    $ThemesCount = $this->ThemesLogs[$strIssues[$idx]['issue_id']]["totS"];    
    if ( (in_array($strIssues[$idx]['type'],$l_SXtheme)) || (in_array($strIssues[$idx]['type'],$l_edittheme)) || (in_array($strIssues[$idx]['type1'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
    <div class="editsections" id="div_sct<?php echo $strIssues[$idx]['issue_id']; ?>"><?php  echo trim($this->ArrThemes[$tag_name][theme]); ?></div><div class="rsltsct1" id="div_sct1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltsct">            
    </div><?php }else { echo $this->ArrThemes[$tag_name][theme]; } 
    if (!empty($ThemesCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }
    ?>
         <div class="rsltsct1" id="div_sct1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'ThemesPosted'.$strIssues[$idx]['issue_id']; ?>" class="ThemesPosted">
            <?php	
                 if($ThemesCount>1){                                   
                 ?>
                 <div id="<?php echo 'Themes_show'.$strIssues[$idx]['issue_id']; ?>" class="Themes_show" style="text-align:center;" value="<?php echo $ThemesCount;?>"><a id="<?php echo 'displayThemes'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesThemesPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($ThemesCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$this->ArrThemes[$arNewvalue[$x]][theme]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>	           
    <hr/>
    <?php
    $arNewvalue2 = explode("~^~",$this->ThemesLogs2[$strIssues[$idx]['issue_id']]["newvalue"]);
    $arUsers2 = explode("~^~",$this->ThemesLogs2[$strIssues[$idx]['issue_id']]["users"]);              
    $arTimestamp2 = explode("~^~",$this->ThemesLogs2[$strIssues[$idx]['issue_id']]["timestamp"]);        
    $ThemesCount2 = $this->ThemesLogs2[$strIssues[$idx]['issue_id']]["totS"];    
    if ( (in_array($strIssues[$idx]['type'],$l_SXtheme)) || (in_array($strIssues[$idx]['type'],$l_edittheme)) || (in_array($strIssues[$idx]['type1'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
    <div class="editsections_2" id="div_sct_2<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo trim(($this->ArrThemes[$tag_name2][theme])? $this->ArrThemes[$tag_name2][theme]:'None'); ?></div><div class="rsltsct1_2" id="div_sct1_2<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltsct">            
    </div><?php }else { echo trim(($this->ArrThemes[$tag_name2][theme])? $this->ArrThemes[$tag_name2][theme]:'None'); } 
    if (!empty($ThemesCount2)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers2[0]."' title='User: ".$arUsers2[0]."' class='new'>".$arUsers2[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp2[0]))."</i>"; }
    ?>
         <div class="rsltsct1_2" id="div_sct1_2<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'ThemesPosted'.$strIssues[$idx]['issue_id']; ?>" class="ThemesPosted">
            <?php	
                 if($ThemesCount2>1){                                   
                 ?>
                 <div id="<?php echo 'Themes_show2'.$strIssues[$idx]['issue_id']; ?>" class="Themes_show2" style="text-align:center;" value="<?php echo $ThemesCount2;?>"><a id="<?php echo 'displayThemes2'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesThemesPosted2'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($ThemesCount2); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$this->ArrThemes[$arNewvalue2[$x]][theme]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers2[$x]."' title='User: ".$arUsers2[$x]."' class='new'>".$arUsers2[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp2[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>	         
    </td>
    <?php     
    }else {?>
    <td valign="top"  style="text-align:center;" >
        <?php 
        if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
        <div class="editsections" id = "div_sct<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo $strIssues[$idx]['type_name']; ?></div>
        <?php }else {echo $strIssues[$idx]['type_name']; } ?>
        <hr/>
        <?php 
        if ((in_array($strIssues[$idx]['type1'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
        <div class="editsections_2" id = "div_sct_2<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo $strIssues[$idx]['type_name1']; ?></div>
        <?php }else {echo $strIssues[$idx]['type_name1']; } ?>
    </td>
    <?php } ?>
		   
    <td valign="top" style="text-align:center;" > 
    <?php 
    $arNewvalue = explode("~^~",$this->StartLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
    $arUsers = explode("~^~",$this->StartLogs[$strIssues[$idx]['issue_id']]["users"]);              
    $arTimestamp = explode("~^~",$this->StartLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
    $StartCount = $this->StartLogs[$strIssues[$idx]['issue_id']]["totS"];    
    if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
    <div class="editstart_date" id="div_str<?php echo $strIssues[$idx]['issue_id'];?>"><?php  if ($strIssues[$idx]['start_date']=='') {echo "Click To Edit";} else {echo $strIssues[$idx]['start_date']; if($strIssues[$idx]['depend_id']!=0) {echo "<br>";echo "Depend ID: ";echo htmlspecialchars($strIssues[$idx]['depend_id'], ENT_QUOTES);};}?></div><div class="rsltstart1" id="div_str1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltstart">
    <?php 
        } else { ?> <?php echo $strIssues[$idx]['start_date']; if($strIssues[$idx]['depend_id']!=0) {echo "<br>";echo "Depend ID: ";echo htmlspecialchars($strIssues[$idx]['depend_id'], ENT_QUOTES);};?><div class="rsltstart1" id="div_str1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltstart">
	 <?php } 
    if (!empty($StartCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }                                    
    ?>
        </div>
        <div class="rsltstart1" id="div_str1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'StartPosted'.$strIssues[$idx]['issue_id']; ?>" class="StartPosted">
            <?php	
                 if($StartCount>1){                                   
                 ?>
                 <div id="<?php echo 'Start_show'.$strIssues[$idx]['issue_id']; ?>" class="Start_show" style="text-align:center;" value="<?php echo $StartCount;?>"><a id="<?php echo 'displayStart'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesStartPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($StartCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>	                          
    <input type="hidden" name="txtstartid<?php echo $strIssues[$idx]['issue_id'];  ?>" value="<?php echo $strIssues[$idx]['status_id']; ?>" />
    </td>     
    
    <td valign="top"   style="text-align:center;" > 
    <?php 
    $arNewvalue = explode("~^~",$this->TargetLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
    $arUsers = explode("~^~",$this->TargetLogs[$strIssues[$idx]['issue_id']]["users"]);              
    $arTimestamp = explode("~^~",$this->TargetLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
    $TargetCount = $this->TargetLogs[$strIssues[$idx]['issue_id']]["totS"];     
    if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>        
    <div class="edittarget_date" id="div_tar<?php echo $strIssues[$idx]['issue_id']; ?>"><?php  if ($strIssues[$idx]['target_date']=='') {echo "Click To Edit";} else {echo $strIssues[$idx]['target_date'];} ?></div><div class="rslttarget1" id="div_tar1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rslttarget">
    <?php 
        } else { ?> <?php echo $strIssues[$idx]['target_date'];  ?><div class="rslttarget1" id="div_tar1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rslttarget">
    <?php } 
    if (!empty($TargetCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }                                    
    ?>
        </div>
        <div class="rslttarget1" id="div_tar1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'TargetPosted'.$strIssues[$idx]['issue_id']; ?>" class="TargetPosted">
            <?php	
                 if($TargetCount>1){                                   
                 ?>
                 <div id="<?php echo 'Target_show'.$strIssues[$idx]['issue_id']; ?>" class="Target_show" style="text-align:center;" value="<?php echo $TargetCount;?>"><a id="<?php echo 'displayTarget'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesTargetPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($TargetCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>	               
    <input type="hidden" name="txttargetid<?php echo $strIssues[$idx]['issue_id'];  ?>" value="<?php echo $strIssues[$idx]['status_id']; ?>" />
    </td> 
            
    <td valign="top"  style="text-align:center;" >
    <?php 
    if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by'] || ($this->getUsrName == $strIssues[$idx]['coor']))){ ?>
    <div class="editdue" id="div_due<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo htmlspecialchars($strIssues[$idx]['due_date'], ENT_QUOTES); if ($strIssues[$idx]['last_modifier']!='') {echo "<br>";echo "by ";echo "<a href='$this->ArticlePath/User:$mdfr'  title='User: $mdfr' class='new'>";echo htmlspecialchars($strIssues[$idx]['last_modifier'], ENT_QUOTES);echo "</a>";}?></div>
    <?php } else { ?><?php echo htmlspecialchars($strIssues[$idx]['due_date'], ENT_QUOTES);if ($strIssues[$idx]['last_modifier']!='') {echo "<br>";echo "by ";echo "<a href='$this->ArticlePath/User:$mdfr' title='User: $mdfr' class='new'>";echo htmlspecialchars($strIssues[$idx]['last_modifier'], ENT_QUOTES);echo "</a";}}?>
    </td>    

    <td valign="top"  style="text-align:center;" >
    <?php 
    $aroldvalue = explode("~^~",$this->nextStepLogs[$strIssues[$idx]['issue_id']]["Lold"]);  
    $nextStepCount = $this->nextStepLogs[$strIssues[$idx]['issue_id']]["totS"];            
    if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
    <div id="div_nxtDate<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="edittgr" id="div_tgr<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo htmlspecialchars($strIssues[$idx]['targ_accom'], ENT_QUOTES); ?></div><div class="rsltnxt" id="div_nxt<?php echo $strIssues[$idx]['issue_id']; ?>">
    <?php } else { ?><?php echo htmlspecialchars($strIssues[$idx]['targ_accom'], ENT_QUOTES); ?><div class="rsltnxt" id="div_nxt<?php echo $strIssues[$idx]['issue_id']; ?>">	
    <?php } ?>
        </div>
        <div class="rsltnxt" id="div_nxt<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
        <div id="<?php echo 'nextStepPosted'.$strIssues[$idx]['issue_id']; ?>" class="nextStepPosted">
            <?php	
                 if($nextStepCount>1){                                   
                 ?>
                 <div id="<?php echo 'nextStep_show'.$strIssues[$idx]['issue_id']; ?>" class="nextStep_show" style="text-align:center;" value="<?php echo $nextStepCount;?>"><a id="<?php echo 'displaynextStep'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesnextStepPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($nextStepCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<i>".$aroldvalue[$x]."</i><br>";                            
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>                
    </td>
        
    <td valign="top"  style="text-align:center;" >
    <?php 
        $arNewvalue = explode("~^~",$this->PriorityLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
        $arUsers = explode("~^~",$this->PriorityLogs[$strIssues[$idx]['issue_id']]["users"]);              
        $arTimestamp = explode("~^~",$this->PriorityLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
        $PriorityCount = $this->PriorityLogs[$strIssues[$idx]['issue_id']]["totS"];       
        if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
        <div class="editpriority" id="div_pry<?php echo $strIssues[$idx]['issue_id']; ?>"><?php  echo $strIssues[$idx]['priority_name']; ?></div><div class="rsltprior1" id="div_pri1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltprior">
    <?php                              
	} else { ?><?php  echo $strIssues[$idx]['priority_name']; ?><div class="rsltprior1" id="div_pri1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltprior">           
    <?php } 
    if (!empty($PriorityCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }                                    
    ?>
        </div>
        <div class="rsltprior1" id="div_pri1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'PriorityPosted'.$strIssues[$idx]['issue_id']; ?>" class="PriorityPosted">
            <?php	
                 if($PriorityCount>1){                                   
                 ?>
                 <div id="<?php echo 'Priority_show'.$strIssues[$idx]['issue_id']; ?>" class="Priority_show" style="text-align:center;" value="<?php echo $PriorityCount;?>"><a id="<?php echo 'displayPriority'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesPriorityPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($PriorityCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>	                                 	 
    </td>    
        
    <td id="td_sts<?php echo $strIssues[$idx]['issue_id']; ?>" valign="top" style="text-align:center; background-color: #<?php echo $strIssues[$idx]['status_color']; ?>">    
    <?php                                                                                
        $arNewvalue = explode("~^~",$this->StatusLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
        $arUsers = explode("~^~",$this->StatusLogs[$strIssues[$idx]['issue_id']]["users"]);              
        $arTimestamp = explode("~^~",$this->StatusLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
        $statusCount = $this->StatusLogs[$strIssues[$idx]['issue_id']]["totS"];
        $rsn = ($strIssues[$idx]['status']=='Bug Pending Development')? $strIssues[$idx]['reason']:"";      
    ?>    
        <?php if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])){ ?>
        <div class="<?php
                if ($this->getUsrName == $strIssues[$idx]['coor']) {                 
                $edit = str_replace('Bug','iTask',$strIssues[$idx]['status']);
                }
                if ($this->getUsrName == $strIssues[$idx]['owned_by'] && $strIssues[$idx]['status']=='Bug Assigned' ) {                
                $edit = 'editstsNew1';
                }                 
                if ( ($this->getUsrName == $strIssues[$idx]['owned_by'] || $this->getUsrName == $strIssues[$idx]['coor']) && $strIssues[$idx]['status']!=='Bug Assigned' ) {
                $edit = 'editstsNew2';
                } 
                if ($this->getUsrName == $strIssues[$idx]['approv_by'] && $strIssues[$idx]['status']=='Bug Pending Approval' ) { 
                $edit = 'editstsNew3';
                } 
                if ( ($this->getUsrName == $strIssues[$idx]['coor_'] || $this->getUsrName == $strIssues[$idx]['approv_by']) && ($strIssues[$idx]['status']=='Bug Working' || $strIssues[$idx]['status']=='Bug Pending Development') ) { 
                $edit = 'editstsNew4';
                }     
                if ( ($this->getUsrName == $strIssues[$idx]['coor'] || $this->getUsrName == $strIssues[$idx]['approv_by']) && $strIssues[$idx]['status']=='Bug Feedback' ) { 
                $edit = 'editstsNew5';
                }    
                if ( ($this->getUsrName == $strIssues[$idx]['coor'] || $this->getUsrName == $strIssues[$idx]['approv_by']) && $strIssues[$idx]['status']=='Bug Pending Feedback' ) { 
                $edit = 'editstsNew1';
                }                               
                echo $edit;
                ////echo ($this->getUsrName == $strIssues[$idx]['approv_by'])? 'editsts':'editsts_0'
             ?>" id="div_sts<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo str_replace('Bug','iTask',$strIssues[$idx]['status']); ?>                
        <?php }else{
        echo str_replace('Bug','iTask',$strIssues[$idx]['status']); }
        echo "<b>".$rsn."</b>";
        if (!empty($statusCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }                                           
        ?>
        </div>
        <div class="rsltsts1" id="div_sttus1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'StatusPosted'.$strIssues[$idx]['issue_id']; ?>" class="StatusPosted">
            <?php	
                 if($statusCount>1){                                   
                 ?>
                 <div id="<?php echo 'status_show'.$strIssues[$idx]['issue_id']; ?>" class="status_show" style="text-align:center;" value="<?php echo $comCount;?>"><a id="<?php echo 'displayStatus'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesStatusPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($statusCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>	                                        
     <input type="hidden" name="txtstatusid<?php echo $strIssues[$idx]['issue_id'];  ?>" value="<?php echo $strIssues[$idx]['status_id']; ?>" />
   </td>    
    
   <td valign="top"  style="text-align:center;" >
   <?php 
        $arNewvalue = explode("~^~",$this->OwnerLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
        $arUsers = explode("~^~",$this->OwnerLogs[$strIssues[$idx]['issue_id']]["users"]);              
        $arTimestamp = explode("~^~",$this->OwnerLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
        $OwnerCount = $this->OwnerLogs[$strIssues[$idx]['issue_id']]["totS"]; 
        if ( !in_array($strIssues[$idx]['owned_by'],$l_owner_list) ) {
                echo $strIssues[$idx]['owned_by'];?><div class="rsltown1" id="div_own1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltown">
                <?php                
        }else{ 
                if ( ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'] || in_array($strIssues[$idx]['type'],$l_SXtheme) )){ ?>
                <div class="edit" id="div_own<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo $strIssues[$idx]['owned_by']; ?></div><div class="rsltown1" id="div_own1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltown">
                <?php }elseif ($strIssues[$idx]['owned_by']=="None") { ?>
                <div class="edit_1" id="div_own<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo $strIssues[$idx]['owned_by']; ?></div><div class="rsltown1" id="div_own1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltown"> 
                <?php        
                } 
                else { 
                ?> <?php echo $strIssues[$idx]['owned_by']; ?><div class="rsltown1" id="div_own1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltown">
                <?php }       
        }         
        if (!empty($OwnerCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }         
        ?>
        </div>
        <div class="rsltown1" id="div_own1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'OwnerPosted'.$strIssues[$idx]['issue_id']; ?>" class="OwnerPosted">
            <?php	
                 if($OwnerCount>1){                                   
                 ?>
                 <div id="<?php echo 'Owner_show'.$strIssues[$idx]['issue_id']; ?>" class="Owner_show" style="text-align:center;" value="<?php echo $OwnerCount;?>"><a id="<?php echo 'displayOwner'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesOwnerPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($OwnerCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>
   </td>
     
    <td valign="top"  style="text-align:center;" >
    <?php 
        $arNewvalue = explode("~^~",$this->CoorLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
        $arUsers = explode("~^~",$this->CoorLogs[$strIssues[$idx]['issue_id']]["users"]);              
        $arTimestamp = explode("~^~",$this->CoorLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
        $CoorCount = $this->CoorLogs[$strIssues[$idx]['issue_id']]["totS"]; 
        if ( ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor']) || in_array($strIssues[$idx]['type'],$l_SXtheme) ){ ?>
        <div class="editcoor" id="div_coo<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo $strIssues[$idx]['coor']; ?></div><div class="rsltcoor1" id="div_corr1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltcoor">
	<?php } else { ?><?php echo $strIssues[$idx]['coor']; ?><div class="rsltcoor1" id="div_corr1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltcoor">
	<?php }        
        if (!empty($CoorCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }         
        ?>
        </div>
        <div class="rsltcoor1" id="div_corr1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'CoorPosted'.$strIssues[$idx]['issue_id']; ?>" class="CoorPosted">
            <?php	
                 if($CoorCount>1){                                   
                 ?>
                 <div id="<?php echo 'Coor_show'.$strIssues[$idx]['issue_id']; ?>" class="Coor_show" style="text-align:center;" value="<?php echo $CoorCount;?>"><a id="<?php echo 'displayCoor'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesCoorPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($CoorCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>
    </td>
		
    <td valign="top"  style="text-align:center;" >
        <?php 
        $arNewvalue = explode("~^~",$this->ApprLogs[$strIssues[$idx]['issue_id']]["newvalue"]);
        $arUsers = explode("~^~",$this->ApprLogs[$strIssues[$idx]['issue_id']]["users"]);              
        $arTimestamp = explode("~^~",$this->ApprLogs[$strIssues[$idx]['issue_id']]["timestamp"]);        
        $ApprCount = $this->ApprLogs[$strIssues[$idx]['issue_id']]["totS"]; 
        $intern_user =  empty(array_search($this->getUsrName,$l_extuser));       
               
        if ( ($intern_user==true) && ( ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor']) || in_array($strIssues[$idx]['type'],$l_SXtheme)  ) ) {                 
        ?>
        <div class="editapp" id="div_app<?php echo $strIssues[$idx]['issue_id']; ?>"><?php echo $strIssues[$idx]['approv_by']; ?></div><div class="rsltapp1" id="div_apr1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltapp">
	<?php } else { ?><?php echo $strIssues[$idx]['approv_by'];?><div class="rsltapp1" id="div_apr1<?php echo $strIssues[$idx]['issue_id']; ?>"></div><div class="rsltapp">
	<?php }        
        if (!empty($ApprCount)) { echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[0]."' title='User: ".$arUsers[0]."' class='new'>".$arUsers[0]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[0]))."</i>"; }         
        ?>
        </div>
        <div class="rsltapp1" id="div_apr1<?php echo $strIssues[$idx]['issue_id']; ?>"></div>        
            <div id="<?php echo 'ApprPosted'.$strIssues[$idx]['issue_id']; ?>" class="ApprPosted">
            <?php	
                 if($ApprCount>1){                                   
                 ?>
                 <div id="<?php echo 'Appr_show'.$strIssues[$idx]['issue_id']; ?>" class="Appr_show" style="text-align:center;" value="<?php echo $ApprCount;?>"><a id="<?php echo 'displayAppr'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();">Show History</a></div>            
                 <?php } ?>     
                 <div id="<?php echo 'tesApprPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                     <?php                      
                         for ($x = 1; $x < ($ApprCount); $x++) {                   
                         ?>                    
                         <div align="center" style="text-align:center; ">                                
                            <?php echo "<strong>".$arNewvalue[$x]."</strong><br/>" ;
                            echo "<i>by <a href='$this->ArticlePath/User:".$arUsers[$x]."' title='User: ".$arUsers[$x]."' class='new'>".$arUsers[$x]."</a><br/>on ".date('d-M-Y  H:i:s',strtotime($arTimestamp[$x]))."</i>"; 
                            ?>                                                                                                                                               
                         </div>                    
                         <?php } ?>                                    
                 </div>	                              
             </div>
    </td>
    
    <td valign="top"  style="text-align:left;" ><div class="more"><?php echo str_replace("\r\n","<br />",$strIssues[$idx]['summary']); ?></div>
	<br />
	<?php
        $basepath=$this->filelocation.$strIssues[$idx]['rndfile'];
        $downloadpath=$this->downloadfileurl."ITaskTrackerUploads/".$strIssues[$idx]['rndfile'];
	#echo $basepath;
	$dir=null;
	if(!is_dir($basepath) || $strIssues[$idx]['rndfile']==""){
                echo "";
        }
	else{		
                $outputfile=null;
                $outputdir=dir($basepath);
                #var_dump($outputdir);
                $j=0;
                while (false !== ($entry = $outputdir->read())) {
                        if($entry != '.' && $entry != '..' && !is_dir($dir.$entry))
                        {
                                $outputfile[$j]=$entry;
                                $j++;
                        }
                }
                $outputdir->close();

                if($j>0){
                        for ($k=0;$k<$j;$k++)
                        {
                                if (!is_dir($downloadpath."/".$outputfile[$k])){
					if (($k>0) && ($k%5==0)){
						echo "<br />";
					}
                                        echo "<a href='".$downloadpath."/".str_replace("+"," ",urlencode($outputfile[$k]))."'  target='_blank'><img src='".$this->ScriptPath."/img/attachment.gif' title='".$outputfile[$k]."' alt='".$outputfile[$k]."' /></a>&nbsp;";
                                }
                        }
                }
                else{
                         echo "";
                }
        }		
	?>

	<div id="<?php echo 'CommentPosted'.$strIssues[$idx]['issue_id']; ?>" class="CommentPosted">
	<?php                                           
        $idxCom=0;                        
        $arCid = explode("~^~",$this->IssueComments[$strIssues[$idx]['issue_id']]["Cid"]);
            //$arComment = explode("~^~",$this->IssueComments[$strIssues[$idx]['issue_id']]["comment"]);
            $arComment = explode("~^~", $this->html_cleanup($this->IssueComments[$strIssues[$idx]['issue_id']]["comment"]));
                $arUsers = explode("~^~",$this->IssueComments[$strIssues[$idx]['issue_id']]["users"]);              
                    $arTimestamp = explode("~^~",$this->IssueComments[$strIssues[$idx]['issue_id']]["timestamp"]);        
        $comCount = $this->IssueComments[$strIssues[$idx]['issue_id']]["totC"];
            if($comCount>1){                                   
            ?>
            <div id="<?php echo 'textshow'.$strIssues[$idx]['issue_id']; ?>" class="textshow" style="text-align:center;background-color:#5F9EAD;" value="<?php echo $comCount;?>"><a id="<?php echo 'displayText'.$strIssues[$idx]['issue_id']; ?>"  href="javascript:toggle();" style="font-size:13px">Show <?php echo $comCount; ?>  Comments</a></div>
            <div id="<?php echo 'comLast'.$strIssues[$idx]['issue_id']; ?>"></div>
            <?php } ?>     
            <div id="<?php echo 'tesCommentPosted'.$strIssues[$idx]['issue_id']; ?>" style="display: none">
                <?php                      
                    for ($x = 0; $x < ($this->IssueComments[$strIssues[$idx]['issue_id']]["totC"]); $x++) {
                    if ($idxCom < $comCount-1) {
                    ?>
                    <div id="<?php echo 'view_comments'.$strIssues[$idx]['issue_id']; ?>"></div>
                    <div id="<?php  echo 'record-'.$arCid[$x];?>" align="left" style="background-color:#d3d3d3; padding-top:5px;padding-left:5px; padding-right:5px; margin-top:3px">
                            <label class="postedComments">
                                    <?php  echo "<strong>".$arUsers[$x]." : </strong> <br />".str_replace("\n","<br />",$arComment[$x]);?>
                            </label>
                            <br clear="all" />
                            <span style="margin-left:2px; color:#666666; font-size:11px; text-align:left">
                                    <?php echo date('d-M-Y : H:i:s',strtotime($arTimestamp[$x])); ?>
                            </span>                    
                            <?php  if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])): ?><a href="#" style="text-align:right" id="<?php  echo 'CID-'.$arCid[$x];?>" class="c_delete" onclick="return delete_comment('<?php echo $arCid[$x]; ?>')" name="c_del<?php echo $strIssues[$idx]['issue_id']; ?>">Delete</a><?php endif; ?>             
                    </div>                    
                <?php 
                    }else{
                    $Last_id=$arCid[$x];
                    $Last_usr=$arUsers[$x];
                    $Last_com=$arComment[$x];
                    $Last_time=$arTimestamp[$x];
                    }
                $idxCom++;               
                }
                ?>
            </div>	             
                 <?php  if ($comCount >0) {?>
                    <div id="<?php echo 'view_comments'.$strIssues[$idx]['issue_id'];?>"></div>               
                    <div id="<?php echo 'record-'.$Last_id;?>" align="left" style="background-color:#d3d3d3; padding-top:5px;padding-left:5px; padding-right:5px; margin-top:3px">
                            <label class="postedComments">
                                    <?php  echo "<strong>".$Last_usr." : </strong> <br />".str_replace("\n","<br />",$Last_com);?>
                            </label>
                    <br clear="all" />
                    <span style="margin-left:2px; color:#666666; font-size:11px; text-align:left">
                            <?php echo date('d-M-Y : H:i:s',strtotime($Last_time));?>
                    </span>                        
                    <?php if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])): ?><a href="#" style="text-align:right" id="<?php  echo 'CID-'.$Last_id;?>" class="c_delete" onclick="return delete_comment('<?php echo $arCid[$x]; ?>')" name="c_del<?php echo $strIssues[$idx]['issue_id']; ?>">Delete</a><?php endif; ?>
                    </div> 
                 <?php }?>
	</div>	

	<div class="commentBox" align="right" id="commentBox-<?php echo $strIssues[$idx]['issue_id']; ?>" >
            <label id="record-<?php echo $strIssues[$idx]['issue_id']; ?>">
                    <textarea class="commentMark" id="commentMark-<?php echo $strIssues[$idx]['issue_id']; ?>" name="commentMark" cols="70">Comment...</textarea>
                    <input type="hidden" id="ibug_id-<?php echo $strIssues[$idx]['issue_id']; ?>" value="<?php echo $strIssues[$idx]['issue_id']; ?>" />
                    <input type="hidden" id="user_name-<?php echo $strIssues[$idx]['issue_id']; ?>" value="<?php echo $this->getUsrName; ?>" />
            </label>
            <br clear="all" />            
                <?php //echo $strIssues[$idx]['status'];
                if ($this->getUsrName == $strIssues[$idx]['owned_by'] && $strIssues[$idx]['status']=="Bug Assigned" ) {
                ?>
                <a id="SubmitCmtWorking-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtworking" style="display:none" title="Comment and Status Working"> Working</a>
                <a id="SubmitCmtFeedback-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtfeedback" style="display:none" title="Comment and Status Feedback"> Feedback</a>
                <a id="SubmitComment-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button comment" style="display:none" title="Comment only"> Comment</a>
                <?php } ?>
                <?php 
                if ( ($this->getUsrName == $strIssues[$idx]['owned_by'] || $this->getUsrName == $strIssues[$idx]['coor']) && $strIssues[$idx]['status']!=="Bug Assigned" ) {
                ?>                
                <a id="SubmitCmtFeedback-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtfeedback" style="display:none" title="Comment and Status Feedback"> Feedback</a>
                <a id="SubmitCmtPendingApprove-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtpendingapprove" style="display:none" title="Comment and Status Send for Approval"> Send App</a>
                <a id="SubmitComment-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button comment" style="display:none" title="Comment only"> Comment</a>
                <?php } ?>
                <?php if ( ($this->getUsrName == $strIssues[$idx]['approv_by'] || $this->getUsrName == $strIssues[$idx]['coor']) && ($strIssues[$idx]['status']=="Bug Pending Approval" || $strIssues[$idx]['status']=="Bug Feedback") ) { ?>
                <a id="SubmitCmtWorking-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtworking" style="display:none" title="Comment and Status Working"> Working</a>
                <a id="SubmitComment-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button comment" style="display:none" title="Comment only"> Comment</a>
                <a id="SubmitCmtApprove-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtapprove" style="display:none" title="Comment and Status Approved"> Approve</a>                
                <a id="SubmitCmtCancel-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtcancel" style="display:none" title="Comment and Status Cancel"> Cancel</a>
                <?php } ?>
                <?php if ( ($this->getUsrName == $strIssues[$idx]['approv_by'] || $this->getUsrName == $strIssues[$idx]['coor_']) && $strIssues[$idx]['status']!=="Bug Pending Approval" ) { ?>
                <a id="SubmitCmtWorking-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtworking" style="display:none" title="Comment and Status Working"> Working</a>
                <a id="SubmitComment-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button comment" style="display:none" title="Comment only"> Comment</a>               
                <a id="SubmitCmtPending-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtpending" style="display:none" title="Comment and Status Pending Development"> Pending</a>
                <a id="SubmitCmtCancel-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cmtcancel" style="display:none" title="Comment and Status Cancel"> Cancel</a>
                <?php } ?>
                <?php if ($this->getUsrName == $strIssues[$idx]['coor']) { ?>                
                <a id="SubmitComment-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button comment" style="display:none" title="Comment only"> Comment</a>               
                <?php } ?>
                <a id="cancelComment-<?php echo $strIssues[$idx]['issue_id']; ?>" class="small button cancel" style="display:none" title="Reset/Clear Comment Box"> Reset</a>            
	</div>	                  
          
    </td>
    
    <td  valign="top" style="text-align:center;" >
    <?php if ($this->isIbugLoggedIn): ?>
    	<?php if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])): ?>[<a href="<?php echo $this->editUrl . $strIssues[$idx]['issue_id']; ?>"><?php echo wfMessage('edit'); ?></a>]&nbsp;<?php endif; ?>	
	<?php 
		if ($this->isIbugArchiver($this->getUsrName)== 1){
		if ($this->filterStatus!="archived"){
			?>
			<br />
			<?php			
                        if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])): ?>[<a href="<?php echo 'javascript:ConfirmArchive(' .$strIssues[$idx]['issue_id'] . ')'; ?>"><?php echo wfMessage('archive'); ?></a>]<?php endif; 
		}
		else
		{
			?>
			<br />
			<?php
			if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])): ?>[<a href="<?php echo $this->undeleteUrl . $strIssues[$idx]['issue_id']; ?>"><?php echo wfMessage('unarchive'); ?></a>]<?php endif;
		}
		}
        ?>
                        <br />
                        <?php 
                        if ((in_array($strIssues[$idx]['type'],$l_edittheme)) || ($this->getUsrName == $strIssues[$idx]['owned_by']) || ($this->getUsrName == $strIssues[$idx]['approv_by']) || ($this->getUsrName == $strIssues[$idx]['coor'])) : ?><div class="ActionEmail" id="bt_email<?php echo $strIssues[$idx]['issue_id']; ?>">[Send Email]</div><?php endif; ?>
    <?php endif; ?>        
    </td>
	
  </tr>
  <?php 
	}
	$idx++;
	endwhile; 
	} ?>
</tbody>
</table>
<br />
<hr size="1" width="100%" />
<strong>Action:</strong> <a href="javascript:selectToggle(true,'frmIbug');">Check All</a> / <a href="javascript:selectToggle(false,'frmIbug');">Uncheck All</a>
&nbsp; <strong> : </strong>
	        <select name="bt_checked_ShortAction">         
			<option value="None">choose</option>
			<?php 
                        $_POST=null;
			$idx=0;						
			foreach ($this->issueShortAction as $name => $shortaction): ?>	                      
				<?php if ($idx==0){ ?>
					<optgroup label="change status" title="Change Status">
				<?php } ?>

				<?php if ($name=="ar0"){ ?>
					</optgroup>
					<optgroup label="Action" title="Action">
				<?php } ?>
				
				<?php
				if (($name!="ar0" && $name!="ar1" && $name!="d") || ($this->filterStatus=="archived" && $name=="ar0" && $this->isIbugArchiver($this->getUsrName)== 1) || ($this->filterStatus!="archived" && $name=="ar1" && $this->isIbugArchiver($this->getUsrName)== 1) || ($this->isIbugApprover($this->getUsrName)==1 && $name=="d")){				
				?>
					<option value="<?php echo $name; ?>"<?php echo ($_POST['bt_checked_ShortAction'] == $name) ? ' selected="true"' : ''; ?>><?php echo $shortaction['name']; ?></option>  				
				<?php
				}								
				 $idx++; ?>
			<?php endforeach; ?>
		</optgroup>
		</select>

 <input type="submit" name="bt_submitShortAction" id="bt_submitShortAction"  value="Update" />
<?php
	$url = (!empty($_SERVER['HTTPS'])) ? "https://".$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'] : "http://".$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];
?>
	<input type="hidden" name="bt_actionreturn" value="<?php echo urldecode($url); ?>" />
	<input type="hidden" name="title" value="<?php echo $this->pageKey; ?>" />
        <input type="hidden" name="project" value="<?php echo $this->project; ?>" />
        <input type="hidden" name="bt_action" value="<?php echo $this->action; ?>" />

<?php if ($this->auth === false || ($this->auth === true && $this->isIbugLoggedIn === true)): ?>
<span class="editsection" style="float:right;padding-right:7px;">[<a href="<?php echo $this->addUrl; ?>"><?php echo wfMessage('add'); ?></a>]</span>
<?php else: ?>
<span class="editsection"  style="float:right;padding-right:7px;"><?php echo wfMessage('login_msg'); ?></span>
<?php endif; ?>

</form>

<br />

<p> </p>
<table border="0">
  <tr>
    <td><strong><?php echo wfMessage('themes'); ?></strong>
    <table cellpadding="3" style="font-size: 90%">
        <tr>
            <?php                 
                $jtx=0;
                foreach ($this->ArrThemes as $tag=>$val) {                 
                    if ($jtx == 5){
                    $jtx=0;
            ?>
		<td width="80" bgcolor="<?php echo $val[colour]; ?>"><?php echo $val[theme]; ?></td>
	</tr>
	<tr>
            <?php
		}
		else{
		$jtx++;
            ?>  
		<td width="80" bgcolor="<?php echo $val[colour]; ?>"><?php echo $val[theme]; ?></td>
            <?php } 
            } 
            ?>
        </tr>
      </table></td>
    	<td style="padding-left: 30px" valign="top">
	<table cellpadding="3" style="font-size: 90%">
	<tr>
		<td colspan="6"><strong>Bug <?php echo wfMessage('status'); ?></strong></td>
	</tr>        
	<tr>	
            <?php foreach ($this->issueStatus as $name => $status):  
             $secondSTS="New Development Status";
             if (substr($status['Gstatus'],0,3)=='bug') { ?>
                <td width="80" bgcolor="#<?php echo $status['colour']; ?>"><?php echo str_replace("Bug","",$status['name']); ?></td>
            <?php }
             if (substr($status['Gstatus'],0,3)=='ori') {
             $secondSTS="Original Status";
             }
            endforeach; ?>
        </tr>
	<tr>
	
        <tr>
               <td colspan="6"><strong><?php echo $secondSTS; ?></strong></td>
        </tr>
        <tr>
            <?php foreach ($this->issueStatus as $name => $status):
             if (substr($status['Gstatus'],0,3)=='new') { ?>
                <td width="80" bgcolor="#<?php echo $status['colour']; ?>"><?php echo str_replace("New Development","",$status['name']); ?></td>
            <?php }
            if (substr($status['Gstatus'],0,3)=='ori') { ?>
                <td width="80" bgcolor="#<?php echo $status['colour']; ?>"><?php echo str_replace("New Development","",$status['name']); ?></td>
            <?php }
             endforeach; ?>		
	</tr>
	
      </table>
	
	</td>
  </tr>   
</table>               